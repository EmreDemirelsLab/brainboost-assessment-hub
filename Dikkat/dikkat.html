<!DOCTYPE html>
<html lang="tr">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>ForTest Dikkat Algoritması</title>
   <style>
       :root {
           --primary: #60a5fa;
           --primary-dark: #2563eb;
           --secondary: #f43f5e;
           --success: #10b981;
           --warning: #f59e0b;
           --danger: #ef4444;
           --light: #f8fafc;
           --dark: #0f172a;
           --gray: #94a3b8;
           --gray-light: #e2e8f0;
           --border-radius: 8px;
           --font-main: 'Segoe UI', Roboto, Arial, sans-serif;
           --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.1);
           --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.15);
           --transition: all 0.3s ease;
           
           /* Responsive değişkenler */
           --container-padding: clamp(15px, 4vw, 50px);
           --font-size-base: clamp(14px, 2vw, 18px);
           --font-size-large: clamp(18px, 3vw, 24px);
           --font-size-xlarge: clamp(24px, 4vw, 48px);
           --font-size-xxlarge: clamp(32px, 6vw, 64px);
           --button-padding: clamp(12px, 2vw, 18px) clamp(20px, 4vw, 40px);
           --gap-size: clamp(10px, 2vw, 20px);
       }

       * {
           margin: 0;
           padding: 0;
           box-sizing: border-box;
       }

       body {
           font-family: var(--font-main);
           line-height: 1.6;
           color: var(--dark);
           background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 50%, #1d4ed8 100%);
           min-height: 100vh;
           display: flex;
           justify-content: center;
           align-items: center;
           padding: clamp(10px, 3vw, 20px);
           font-size: var(--font-size-base);
       }

       /* Container dinamik boyutta - koyu mavi tema */
       .container {
           background: linear-gradient(145deg, #1e3a8a 0%, #1e40af 100%);
           color: white;
           border-radius: clamp(15px, 3vw, 20px);
           box-shadow: 
               0 25px 50px rgba(0, 0, 0, 0.4),
               0 15px 30px rgba(0, 0, 0, 0.3),
               inset 0 2px 5px rgba(255, 255, 255, 0.1);
           padding: var(--container-padding);
           width: min(100%, 1200px);
           height: min(100vh - clamp(20px, 6vw, 40px), 800px);
           min-height: clamp(500px, 80vh, 600px);
           text-align: center;
           position: relative;
           border: 1px solid rgba(255, 255, 255, 0.2);
           overflow: hidden;
           display: flex;
           flex-direction: column;
       }

       .header {
           margin-bottom: clamp(15px, 4vw, 30px);
       }

       .header h1 {
           color: white;
           margin-bottom: clamp(5px, 2vw, 10px);
           font-size: var(--font-size-xxlarge);
           font-weight: 700;
           letter-spacing: -0.5px;
           text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
           line-height: 1.2;
       }

       .header p {
           color: rgba(255, 255, 255, 0.8);
           font-size: var(--font-size-large);
           line-height: 1.8;
       }

       .screen {
           display: none;
           position: absolute;
           top: 0;
           left: 0;
           width: 100%;
           height: 100%;
           padding: var(--container-padding);
       }

       .screen.active {
           display: flex;
           flex-direction: column;
           justify-content: center;
           align-items: center;
       }

       /* Başlangıç ekranı */
       .title-screen h1 {
           font-size: var(--font-size-xxlarge);
           color: white;
           font-weight: 700;
           margin-bottom: clamp(25px, 6vw, 50px);
           text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
           line-height: 1.2;
       }

       .instruction-box {
           background: transparent;
           border-radius: 0;
           padding: clamp(10px, 3vw, 20px);
           margin: clamp(15px, 4vw, 30px) auto;
           max-width: min(90%, 800px);
           box-shadow: none;
           border: none;
       }

       .instruction-text {
           font-size: var(--font-size-large);
           color: rgba(255, 255, 255, 0.9);
           margin-bottom: clamp(10px, 3vw, 20px);
           line-height: 1.8;
       }

       .highlight-text {
           color: white;
           font-weight: bold;
           font-size: clamp(20px, 3.5vw, 28px);
           margin: clamp(10px, 3vw, 20px) 0;
           line-height: 1.8;
           text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
       }

       .btn {
           display: inline-block;
           font-weight: 500;
           color: white;
           text-align: center;
           vertical-align: middle;
           cursor: pointer;
           background: linear-gradient(135deg, #1e40af 0%, #2563eb 100%);
           padding: var(--button-padding);
           font-size: clamp(16px, 2.5vw, 22px);
           line-height: 1.5;
           border-radius: var(--border-radius);
           transition: var(--transition);
           border: none;
           box-shadow: 
               0 4px 6px rgba(30, 64, 175, 0.3),
               0 0 15px rgba(255, 255, 255, 0.3),
               0 0 25px rgba(255, 255, 255, 0.1);
           text-decoration: none;
           margin: clamp(5px, 1vw, 10px);
           opacity: 0;
           transform: translateY(20px);
           min-width: clamp(100px, 20vw, 150px);
       }

       .btn.visible {
           opacity: 1;
           transform: translateY(0);
       }

       .btn:hover {
           background: linear-gradient(135deg, #1e3d9f 0%, #2454d6 100%);
           box-shadow: 
               0 6px 8px rgba(30, 58, 138, 0.4),
               0 0 20px rgba(255, 255, 255, 0.4),
               0 0 35px rgba(255, 255, 255, 0.15);
           transform: translateY(-2px);
       }

       .btn-bottom-right {
           position: absolute;
           bottom: clamp(20px, 4vw, 40px);
           right: clamp(20px, 4vw, 40px);
           opacity: 0;
           transition: opacity 0.5s ease;
       }

       .btn-bottom-right.visible {
           opacity: 1;
       }



       /* Sonuç ekranı */
       .result-message {
           font-size: clamp(28px, 5vw, 48px);
           color: white;
           font-weight: 600;
           text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
           margin-bottom: clamp(15px, 4vw, 30px);
           line-height: 1.2;
       }

       .result-info {
           font-size: var(--font-size-large);
           color: rgba(255, 255, 255, 0.8);
           font-weight: 500;
       }

       .numbers-display, .letters-display, .question-display {
           display: flex;
           flex-wrap: wrap;
           justify-content: center;
           align-items: center;
           gap: clamp(8px, 2vw, 16px);
           margin: clamp(15px, 4vw, 30px) auto;
           opacity: 1;
           transition: opacity 1s ease;
           position: relative;
           perspective: 1000px;
           transform-style: preserve-3d;
           width: 100%;
           max-width: min(95%, 700px);
           min-height: clamp(60px, 12vh, 120px);
           padding: clamp(5px, 1vw, 15px);
       }

       .option-btn {
           /* Dinamik boyutlandırma - viewport temelli */
           width: clamp(50px, 12vw, 85px);
           height: clamp(50px, 12vw, 85px);
           padding: 0;
           font-size: clamp(16px, 3.5vw, 24px);
           font-weight: bold;
           border: clamp(1px, 0.3vw, 2px) solid rgba(255, 255, 255, 0.3);
           background: rgba(255, 255, 255, 0.9);
           color: black;
           border-radius: clamp(6px, 1.5vw, 12px);
           cursor: pointer;
           transition: all 0.3s ease;
           font-family: Arial, sans-serif;
           display: flex;
           align-items: center;
           justify-content: center;
           box-shadow: 
               0 clamp(2px, 0.5vw, 4px) clamp(4px, 1vw, 6px) rgba(0, 0, 0, 0.2),
               0 1px 3px rgba(0, 0, 0, 0.15),
               inset 0 2px 2px rgba(255, 255, 255, 0.8);
           transform: translateZ(0);
           backface-visibility: hidden;
           position: relative;
           flex-shrink: 0;
           aspect-ratio: 1 / 1;
       }

       .option-btn:hover {
           background: rgba(255, 255, 255, 0.9);
           border-color: rgba(255, 255, 255, 0.3);
           color: black;
           box-shadow: 
               0 clamp(2px, 0.5vw, 4px) clamp(4px, 1vw, 6px) rgba(0, 0, 0, 0.2),
               0 1px 3px rgba(0, 0, 0, 0.15),
               inset 0 2px 2px rgba(255, 255, 255, 0.8);
       }

       .option-btn.selected {
           background: linear-gradient(135deg, #90cdf4 0%, #60a5fa 100%) !important;
           color: black !important;
           border-color: #90cdf4 !important;
           box-shadow: 
               0 clamp(2px, 0.5vw, 4px) clamp(4px, 1vw, 6px) rgba(0, 0, 0, 0.2),
               0 1px 3px rgba(0, 0, 0, 0.15),
               inset 0 2px 2px rgba(255, 255, 255, 0.8) !important;
       }

       .option-btn.clicked {
           background: linear-gradient(135deg, #90cdf4 0%, #60a5fa 100%) !important;
           color: black !important;
           border-color: #90cdf4 !important;
           box-shadow: 
               0 clamp(2px, 0.5vw, 4px) clamp(4px, 1vw, 6px) rgba(0, 0, 0, 0.2),
               0 1px 3px rgba(0, 0, 0, 0.15),
               inset 0 2px 2px rgba(255, 255, 255, 0.8);
       }

       .fake-cursor {
           position: absolute;
           width: clamp(18px, 3vw, 22px);
           height: clamp(18px, 3vw, 22px);
           background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"><path d="M0,0 L0,16 L4,12 L7,19 L10,18 L7,11 L12,11 Z" fill="black" stroke="white" stroke-width="1"/></svg>');
           background-size: contain;
           background-repeat: no-repeat;
           pointer-events: none;
           z-index: 1000;
           opacity: 0;
           transition: all 1.5s ease;
           transform: scale(1);
           transform-origin: top left;
           filter: none;
       }

       .example-text {
           font-size: clamp(16px, 2.5vw, 22px);
           color: white;
           font-weight: 500;
           text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.5);
           position: absolute;
           bottom: clamp(20px, 4vw, 40px);
           left: 50%;
           transform: translateX(-50%);
           z-index: 100;
           text-align: center;
           width: max-content;
           max-width: 80%;
           padding: clamp(12px, 2vw, 18px) clamp(20px, 4vw, 40px);
           background: rgba(30, 64, 175, 0.8);
           backdrop-filter: blur(8px);
           border-radius: var(--border-radius);
           line-height: 1.5;
           margin: clamp(5px, 1vw, 10px);
           border: 1px solid rgba(255, 255, 255, 0.2);
           animation: fadeInUp 0.8s ease-out;
       }

       @keyframes fadeInUp {
           from {
               opacity: 0;
               transform: translateX(-50%) translateY(20px);
           }
           to {
               opacity: 1;
               transform: translateX(-50%) translateY(0);
           }
       }

       .timer {
           position: fixed;
           top: clamp(10px, 2vw, 20px);
           right: clamp(10px, 2vw, 20px);
           background-color: var(--primary);
           color: white;
           padding: clamp(8px, 1.5vw, 10px) clamp(12px, 2vw, 15px);
           border-radius: var(--border-radius);
           font-weight: bold;
           box-shadow: var(--shadow-md);
           z-index: 100;
           font-size: clamp(14px, 2vw, 18px);
       }

       .progress-container {
           position: absolute;
           bottom: 0;
           left: 0;
           width: 100%;
           height: clamp(6px, 1vw, 8px);
           background-color: #e2e8f0;
           border-bottom-left-radius: clamp(15px, 3vw, 20px);
           border-bottom-right-radius: clamp(15px, 3vw, 20px);
           overflow: hidden;
       }

       .progress-bar {
           height: 100%;
           width: 100%;
           background: linear-gradient(90deg, #3b82f6 0%, #60a5fa 100%);
           transition: transform 1s linear;
           transform-origin: left;
           transform: scaleX(0);
           border-bottom-left-radius: clamp(15px, 3vw, 20px);
           border-bottom-right-radius: clamp(15px, 3vw, 20px);
       }

       .stats {
           display: grid;
           grid-template-columns: repeat(auto-fit, minmax(clamp(120px, 25vw, 150px), 1fr));
           gap: clamp(10px, 3vw, 20px);
           margin: clamp(15px, 4vw, 30px) 0;
       }

       .stat-box {
           background: var(--light);
           padding: clamp(10px, 3vw, 20px);
           border-radius: var(--border-radius);
           border: 2px solid var(--gray-light);
       }

       .stat-number {
           font-size: clamp(24px, 4vw, 32px);
           font-weight: bold;
           color: var(--primary);
       }

       .stat-label {
           font-size: var(--font-size-base);
           color: var(--gray);
           margin-top: 5px;
       }

       .question-counter {
           font-size: clamp(14px, 2vw, 18px);
           color: rgba(255, 255, 255, 0.8);
           margin-bottom: clamp(10px, 3vw, 20px);
       }

       /* Form stilleri */
       .form-container {
           max-width: min(90%, 600px);
           margin: clamp(15px, 4vw, 30px) auto;
           text-align: left;
       }

       .form-group {
           margin-bottom: clamp(15px, 3vw, 20px);
       }

       .form-group label {
           display: block;
           margin-bottom: clamp(6px, 1.5vw, 8px);
           color: white;
           font-weight: 500;
           font-size: clamp(14px, 2vw, 18px);
       }

       .form-control {
           width: 100%;
           padding: clamp(10px, 2vw, 12px) clamp(12px, 2.5vw, 15px);
           border: 2px solid rgba(255, 255, 255, 0.3);
           border-radius: clamp(6px, 1vw, 8px);
           font-size: clamp(14px, 2vw, 18px);
           transition: all 0.3s ease;
           background: rgba(255, 255, 255, 0.9);
           color: #1e40af;
       }

       .form-control:focus {
           border-color: #90cdf4;
           box-shadow: 0 0 0 3px rgba(144, 205, 244, 0.2);
           outline: none;
           background: white;
       }

       .form-row {
           display: flex;
           gap: clamp(10px, 3vw, 20px);
           margin-bottom: clamp(15px, 3vw, 20px);
           flex-wrap: wrap;
       }

       .form-row > div {
           flex: 1;
           min-width: clamp(200px, 40vw, 250px);
       }

       select.form-control {
           appearance: none;
           background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%23666' viewBox='0 0 16 16'%3E%3Cpath d='M8 11L3 6h10l-5 5z'/%3E%3C/svg%3E");
           background-repeat: no-repeat;
           background-position: right 15px center;
           padding-right: clamp(30px, 6vw, 40px);
       }

       .error-message {
           color: var(--danger);
           font-size: clamp(12px, 1.8vw, 14px);
           margin-top: 5px;
           display: none;
       }

       /* Responsive breakpoints */
       
               /* Çok küçük telefon ekranları */
        @media (max-width: 360px) {
            .numbers-display, .letters-display, .question-display {
                gap: clamp(4px, 1vw, 8px);
                max-width: 100%;
                padding: clamp(3px, 0.5vw, 10px);
            }
            
            .option-btn {
                width: clamp(45px, 14vw, 60px);
                height: clamp(45px, 14vw, 60px);
                font-size: clamp(14px, 4vw, 18px);
                border-radius: clamp(4px, 1vw, 8px);
            }
            
            .container {
                padding: clamp(10px, 3vw, 15px);
            }
        }

        /* Küçük telefon ekranları */
        @media (max-width: 480px) {
            .form-row {
                flex-direction: column;
            }
            
            .form-row > div {
                min-width: 100%;
            }
            
            .numbers-display, .letters-display, .question-display {
                gap: clamp(6px, 1.5vw, 12px);
                justify-content: space-evenly;
                max-width: 100%;
            }
            
            .option-btn {
                width: clamp(48px, 13vw, 70px);
                height: clamp(48px, 13vw, 70px);
                font-size: clamp(15px, 3.8vw, 20px);
            }
            
            .btn-bottom-right {
                position: relative;
                bottom: auto;
                right: auto;
                margin-top: 20px;
            }
        }

        /* Tablet dikey */
        @media (min-width: 481px) and (max-width: 768px) {
            .numbers-display, .letters-display, .question-display {
                gap: clamp(10px, 2vw, 15px);
                max-width: min(90%, 650px);
            }
            
            .option-btn {
                width: clamp(60px, 11vw, 75px);
                height: clamp(60px, 11vw, 75px);
                font-size: clamp(18px, 3.2vw, 22px);
            }
            
            .container {
                height: min(100vh - 20px, 700px);
            }
        }

        /* Tablet yatay */
        @media (min-width: 769px) and (max-width: 1024px) {
            .numbers-display, .letters-display, .question-display {
                gap: clamp(12px, 2.2vw, 18px);
                max-width: min(85%, 700px);
            }
            
            .option-btn {
                width: clamp(65px, 10vw, 80px);
                height: clamp(65px, 10vw, 80px);
                font-size: clamp(19px, 3vw, 24px);
            }
            
            .container {
                height: min(100vh - 30px, 750px);
            }
        }

       /* Büyük masaüstü ekranları */
       @media (min-width: 1400px) {
           .container {
               width: min(90%, 1400px);
               height: min(100vh - 40px, 900px);
           }
       }

       /* Çok geniş ekranlar */
       @media (min-width: 1800px) {
           .container {
               width: min(80%, 1600px);
               height: min(100vh - 60px, 1000px);
           }
       }

       /* Yüksek çözünürlüklü ekranlar için font optimizasyonu */
       @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
           .header h1, .title-screen h1, .result-message {
               -webkit-font-smoothing: antialiased;
               -moz-osx-font-smoothing: grayscale;
           }
       }

       /* Landscape mode mobil */
       @media (max-height: 500px) and (orientation: landscape) {
           .container {
               height: 95vh;
               padding: 15px;
           }
           
           .title-screen h1 {
               margin-bottom: 20px;
           }
           
           .instruction-box {
               padding: 20px;
               margin: 15px auto;
           }
       }

               /* Touch device optimizasyonları */
        @media (hover: none) and (pointer: coarse) {
            .option-btn {
                min-width: clamp(48px, 12vw, 80px);
                min-height: clamp(48px, 12vw, 80px);
                /* Touch feedback iyileştirmesi */
                transform-origin: center;
            }
            
            .option-btn:active {
                transition: transform 0.1s ease;
            }
            
            .btn {
                min-height: clamp(44px, 8vw, 56px);
                /* Touch-friendly padding */
                padding: clamp(12px, 3vw, 18px) clamp(24px, 5vw, 40px);
            }
            
            /* Touch device için gap artırması */
            .numbers-display, .letters-display, .question-display {
                gap: clamp(10px, 3vw, 20px);
            }
        }
   </style>
</head>
<body>
   <div class="container">
       <!-- 1. Hoş Geldiniz Ekranı -->
       <div id="welcomeScreen" class="screen active">
           <div class="title-screen">
               <h1>ForTest Bilişsel Beceri Testi</h1>
           </div>
           <button class="btn btn-bottom-right visible" onclick="goToSoundSetup()">İleri</button>
       </div>

       <!-- 2. Ses Ayarlama Ekranı -->
       <div id="soundSetupScreen" class="screen">
           <div class="instruction-box">
               <div class="instruction-text">
                   Ses düzeyini anlatıcının 5'e kadar saydığını rahat ve net bir şekilde duyabileceğiniz şekilde ayarlayın. 
                   Böylece açıklamaları net bir şekilde anlayabilirsiniz.
               </div>
               <div class="highlight-text">
                   Teste başlamaya hazır olduğunuzda "ileri" butonuna basınız.
               </div>
           </div>
           <button class="btn btn-bottom-right" id="soundNextBtn" onclick="goToInstructions()">İleri</button>
       </div>

       <!-- 3. Talimatlar Ekranı -->
       <div id="instructionsScreen" class="screen">
           <div class="instruction-box">
               <div class="highlight-text">
                   Verilen satırda birbirinin aynı olan rakam veya harfleri en hızlı şekilde işaretle.
               </div>
           </div>
           <button class="btn btn-bottom-right" id="instructionsNextBtn" onclick="goToIntroDemo()">İleri</button>
       </div>

       <!-- 4. Giriş Demonstrasyonu -->
       <div id="introDemoScreen" class="screen">
           <div id="introNumbers" class="numbers-display">
               <div class="option-btn">6</div>
               <div class="option-btn">3</div>
               <div class="option-btn" id="target-9-1">9</div>
               <div class="option-btn">5</div>
               <div class="option-btn" id="target-9-2">9</div>
               <div class="option-btn">2</div>
               <div class="fake-cursor" id="introCursor"></div>
           </div>
           <div class="example-text">Örneği dikkatle izleyin.</div>
           <button class="btn btn-bottom-right" id="introNextBtn" onclick="goToLetterDemo()">İleri</button>
       </div>

       <!-- 5. Harf Demonstrasyonu -->
       <div id="letterDemoScreen" class="screen">
           <div id="letterDisplay" class="letters-display">
               <div class="option-btn">a</div>
               <div class="option-btn" id="target-c-1">c</div>
               <div class="option-btn">v</div>
               <div class="option-btn">d</div>
               <div class="option-btn" id="target-c-2">c</div>
               <div class="option-btn">z</div>
               <div class="fake-cursor" id="letterCursor"></div>
           </div>
           <div class="example-text">Örneği dikkatle izleyin.</div>
           <button class="btn btn-bottom-right" id="letterNextBtn" onclick="goToExampleTransition()">İleri</button>
       </div>

       <!-- 6. Örnek Uygulama Geçiş -->
       <div id="exampleTransitionScreen" class="screen">
           <div class="instruction-box">
               <div class="highlight-text">
                   Örnek uygulamaya geçmek için "ileri" butonuna tıklayın!
               </div>
           </div>
           <button class="btn btn-bottom-right" id="exampleTransitionBtn" onclick="goToExampleStart()">İleri</button>
       </div>

       <!-- 7. Örnek Uygulama Başlangıç -->
       <div id="exampleStartScreen" class="screen">
           <div class="instruction-box">
               <div class="highlight-text">
                   Örnek uygulamaya hazırsanız "başla" butonuna tıklayın!
               </div>
           </div>
           <button class="btn btn-bottom-right" id="exampleStartBtn" onclick="startPracticeTest()">Başla</button>
       </div>

       <!-- 8. Örnek Uygulama -->
       <div id="practiceTestScreen" class="screen">
           <div id="practiceDisplay" class="question-display"></div>
           <div class="progress-container">
               <div id="practiceProgressBar" class="progress-bar"></div>
           </div>
       </div>

       <!-- 9. Örnek Uygulama Tamamlandı -->
       <div id="exampleCompleteScreen" class="screen">
           <div class="instruction-box">
               <div class="highlight-text">
                   Örnek uygulamayı tamamladınız!
               </div>
           </div>
           <button class="btn btn-bottom-right" id="exampleCompleteBtn" onclick="goToMainTestIntro()">İleri</button>
       </div>

       <!-- 10. Ana Test Hazırlık -->
       <div id="mainTestIntroScreen" class="screen">
           <div class="instruction-box">
               <div class="highlight-text">
                   Teste hazırlanın! Testi tamamlamak için 3 dakikanız var.
               </div>
           </div>
           <button class="btn btn-bottom-right" id="mainTestIntroBtn" onclick="startMainTest()">Başla</button>
       </div>

       <!-- 11. Ana Test -->
       <div id="mainTestScreen" class="screen">
           <div id="mainDisplay" class="question-display"></div>
           <div class="progress-container">
               <div id="mainProgressBar" class="progress-bar"></div>
           </div>
       </div>

       <!-- 12. Test Tamamlandı -->
       <div id="resultsScreen" class="screen">
           <div class="result-message">Testi tamamladınız!</div>
           <div class="result-info">Sıradaki bölüme geçmek için ileri butonuna tıklayın!</div>
           <button class="btn btn-bottom-right visible" onclick="completeTest()">İleri</button>
       </div>
   </div>

   <script>
       // Test verileri
       const testData = {
           practiceQuestions: [
               { question: ['o', 'k', 'o', 'm', 't', 'y'], target: 'o' },
               { question: ['56', '79', '27', '60', '23', '56'], target: '56' },
               { question: ['ke', 'me', 'em', 'ke', 'en', 'mn'], target: 'ke' },
               { question: ['5', '8', '3', '9', '2', '5'], target: '5' },
               { question: ['6k1', 'k61', 'k16', '61k', 'k16', '16k'], target: 'k16' }
           ],
           
           mainQuestions: [
               { question: ['5', '6', '2', '1', '5', '8'], target: '5' },
               { question: ['m', 't', 'k', 'a', 't', 'h'], target: 't' },
               { question: ['6', '1', '5', '2', '3', '3'], target: '3' },
               { question: ['y', 'd', 'u', 'v', 'u', 'p'], target: 'u' },
               { question: ['6', '1', '3', '1', '5', '8'], target: '1' },
               { question: ['7', '4', '2', '1', '8', '4'], target: '4' },
               { question: ['n', 'a', 'e', 'c', 'e', 'm'], target: 'e' },
               { question: ['7', '4', '6', '2', '5', '6'], target: '6' },
               { question: ['d', 'h', 'k', 'd', 'b', 'o'], target: 'd' },
               { question: ['2', '7', '5', '9', '4', '9'], target: '9' },
               { question: ['s', 'y', 'd', 'g', 's', 'p'], target: 's' },
               { question: ['3', '8', '5', '2', '5', '6'], target: '5' },
               { question: ['m', 'n', 'j', 'c', 'm', 'ç'], target: 'm' },
               { question: ['84', '56', '86', '45', '57', '45'], target: '45' },
               { question: ['ta', 'at', 'al', 'li', 'at', 'il'], target: 'at' },
               { question: ['68', '48', '86', '68', '84', '54'], target: '68' },
               { question: ['ık', 'na', 'ku', 'ok', 'ık', 'ka'], target: 'ık' },
               { question: ['24', '42', '74', '45', '27', '74'], target: '74' },
               { question: ['me', 'na', 'en', 'na', 'ma', 'ne'], target: 'na' },
               { question: ['69', '92', '26', '96', '62', '62'], target: '62' },
               { question: ['şı', 'ce', 'şe', 'ça', 'ca', 'ça'], target: 'ça' },
               { question: ['72', '27', '52', '22', '25', '72'], target: '72' },
               { question: ['hi', 'hı', 'ıh', 'ik', 'ik', 'ih'], target: 'ik' },
               { question: ['43', '48', '84', '38', '83', '43'], target: '43' },
               { question: ['ro', 'no', 'on', 'ru', 'ro', 'un'], target: 'ro' },
               { question: ['13', '31', '24', '24', '12', '35'], target: '24' },
               { question: ['bı', 'ıd', 'bi', 'ıd', 'ib', 'di'], target: 'ıd' },
               { question: ['52', '25', '55', '55', '22', '24'], target: '55' },
               { question: ['uç', 'aş', 'şi', 'uş', 'şe', 'uş'], target: 'uş' },
               { question: ['36', '23', '63', '32', '33', '36'], target: '36' },
               { question: ['yku', 'nkv', 'mac', 'yhg', 'ylg', 'yku'], target: 'yku' },
               { question: ['375', '562', '656', '756', '356', '656'], target: '656' },
               { question: ['cau', 'uau', 'cua', 'cuv', 'uca', 'cau'], target: 'cau' },
               { question: ['424', '243', '424', '342', '234', '324'], target: '424' },
               { question: ['lhm', 'hlm', 'hml', 'mlh', 'lmh', 'mlh'], target: 'mlh' },
               { question: ['852', '258', '285', '258', '825', '582'], target: '258' },
               { question: ['7ç1', 'ç71', 'ç17', '71ç', 'ç17', '17ç'], target: 'ç17' },
               { question: ['289', '298', '982', '928', '829', '982'], target: '982' },
               { question: ['sbv', 'nzı', 'sbm', 'sdg', 'sbm', 'sag'], target: 'sbm' },
               { question: ['636', '361', '636', '163', '316', '136'], target: '636' },
               { question: ['env', 'vzn', 'evn', 'evk', 'ven', 'evk'], target: 'evk' },
               { question: ['525', '528', '285', '582', '528', '825'], target: '528' },
               { question: ['ıvs', 'svs', 'ısv', 'ısh', 'sıv', 'ısh'], target: 'ısh' },
               { question: ['969', '964', '649', '694', '964', '946'], target: '964' },
               { question: ['mhm', 'hmm', 'hhm', 'hmh', 'mmh', 'mmh'], target: 'mmh' },
               { question: ['817', '187', '781', '718', '871', '718'], target: '718' },
               { question: ['2v5', 'v52', 'v25', '25v', 'v52', '52v'], target: 'v52' },
               { question: ['652', '256', '562', '526', '625', '256'], target: '256' },
               { question: ['4g4', '4gg', '44g', '4g4', 'g4g', 'g44'], target: '4g4' },
               { question: ['797', '797', '369', '697', '973', '396'], target: '797' }
           ]
       };

       // Test durumu
       let testState = {
           currentScreen: 'welcome',
           currentAudio: null,
           soundLoopTimer: null,
           animationTimer: null,
           
           // Demonstrasyon durumları - sıfırla
           hasSeenIntro: false,
           hasSeenLetter: false,
           
           // Pratik test
           practiceIndex: 0,
           practiceAnswers: [],
           practiceTimer: null,
           practiceTimeLeft: 30,
           practiceStartTime: null,
           
           // Ana test
           mainIndex: 0,
           mainAnswers: [],
           mainTimer: null,
           mainTimeLeft: 180,
           mainStartTime: null,
           questionStartTime: null,
           reactionTimes: []
       };

       // Ses çalmak için yardımcı fonksiyon
       function playAudio(filename, loop = false) {
           // Önceki sesi durdur
           stopCurrentAudio();
           
           // Yeni ses çal
           const audio = new Audio(`./mp3/${filename}`);
           audio.loop = loop;
           testState.currentAudio = audio;
           
           audio.play().catch(error => {
               console.log('Ses çalma hatası:', error);
           });
           
           return audio;
       }

       // Mevcut sesi durdur
       function stopCurrentAudio() {
           if (testState.currentAudio) {
               testState.currentAudio.pause();
               testState.currentAudio.currentTime = 0;
               testState.currentAudio = null;
           }
           
           // Timer'ları temizle
           if (testState.soundLoopTimer) {
               clearTimeout(testState.soundLoopTimer);
               testState.soundLoopTimer = null;
           }
           
           if (testState.animationTimer) {
               clearInterval(testState.animationTimer);
               testState.animationTimer = null;
           }
       }

       // Ekran değiştirme
       function showScreen(screenId) {
           document.querySelectorAll('.screen').forEach(screen => {
               screen.classList.remove('active');
           });
           document.getElementById(screenId).classList.add('active');
           testState.currentScreen = screenId;
       }

       // Demonstrasyon durumunu sıfırla
       function resetDemoStates() {
           testState.hasSeenIntro = false;
           testState.hasSeenLetter = false;
           
           // UI'ları temizle
           document.getElementById('instructionsNextBtn').classList.remove('visible');
           document.getElementById('introNumbers').classList.remove('visible');
           document.getElementById('introNextBtn').classList.remove('visible');
           document.getElementById('letterDisplay').classList.remove('visible');
           document.getElementById('letterNextBtn').classList.remove('visible');
           document.getElementById('exampleTransitionBtn').classList.remove('visible');
           document.getElementById('exampleStartBtn').classList.remove('visible');
           document.getElementById('exampleCompleteBtn').classList.remove('visible');
       }

       // 1. Ses ayarlama ekranına geç
       function goToSoundSetup() {
           stopCurrentAudio();
           showScreen('soundSetupScreen');
           
           // 12345.mp3'ü loop olarak çal (1 saniye aralıklarla)
           function playCountingLoop() {
               playAudio('12345.mp3');
               testState.currentAudio.addEventListener('ended', () => {
                   testState.soundLoopTimer = setTimeout(() => {
                       playCountingLoop();
                   }, 1000);
               });
           }
           
           playCountingLoop();
           
           // İleri butonunu 2 saniye sonra göster
           setTimeout(() => {
               document.getElementById('soundNextBtn').classList.add('visible');
           }, 2000);
       }

       // 2. Talimatlar ekranına geç
       function goToInstructions() {
           stopCurrentAudio();
           showScreen('instructionsScreen');
           
           // giriş.mp3'ü çal
           playAudio('giriş.mp3');
           
           // Ses bitince ileri butonunu göster
           testState.currentAudio.addEventListener('ended', () => {
               document.getElementById('instructionsNextBtn').classList.add('visible');
           });
       }

       // 3. Giriş demonstrasyonuna geç
       function goToIntroDemo() {
           stopCurrentAudio();
           showScreen('introDemoScreen');
           
           // Sayıları hemen göster
           document.getElementById('introNumbers').classList.add('visible');
           
           // Eğer daha önce görülmüşse, butonları hemen göster
           if (testState.hasSeenIntro) {
               document.getElementById('introNextBtn').classList.add('visible');
               startIntroAnimation();
               return;
           }
           
           testState.hasSeenIntro = true;
           
           // örnek1.mp3'ü çal
           playAudio('örnek1.mp3');
           
           // Animasyonu hemen başlat
           startIntroAnimation();
           
           // Ses bitince butonu göster
           testState.currentAudio.addEventListener('ended', () => {
               document.getElementById('introNextBtn').classList.add('visible');
           });
       }

       // Giriş animasyonu (9'lara tıklama) - FAKE CURSOR
       function startIntroAnimation() {
           const cursor = document.getElementById('introCursor');
           const targets = ['target-9-1', 'target-9-2'];
           let currentTarget = 0;
           let isFirstAnimation = true;
           
           function animateToTarget() {
               const targetElement = document.getElementById(targets[currentTarget]);
               
               if (!targetElement) return;
               
               // Delay hesaplaması
               const delay = isFirstAnimation ? 100 : 0;
               
               // Sadece ilk animasyonda cursor'u başlangıç pozisyonuna getir
               if (isFirstAnimation) {
                   cursor.style.opacity = '1';
                   cursor.style.left = '50px';
                   cursor.style.top = '50px';
                   cursor.style.transition = 'none';
                   isFirstAnimation = false;
               }
               
               // Target element'in pozisyonunu al (parent'a göre)
               const targetRect = targetElement.getBoundingClientRect();
               const parentRect = targetElement.parentElement.getBoundingClientRect();
               
               // Hedef pozisyonunu hesapla
               const targetX = targetRect.left - parentRect.left + (targetElement.offsetWidth / 2) - 10;
               const targetY = targetRect.top - parentRect.top + (targetElement.offsetHeight / 2) - 10;
               
               // Hedefe hareket et
               setTimeout(() => {
                   cursor.style.transition = 'left 1s ease-in-out, top 1s ease-in-out';
                   cursor.style.left = targetX + 'px';
                   cursor.style.top = targetY + 'px';
               }, delay);
               
               // 1.5 saniye sonra tıklama efekti
               setTimeout(() => {
                   targetElement.classList.add('clicked');
                   
                   setTimeout(() => {
                       targetElement.classList.remove('clicked');
                       currentTarget = (currentTarget + 1) % targets.length;
                   }, 1400);
               }, 1500);
           }
           
           animateToTarget();
           testState.animationTimer = setInterval(animateToTarget, 3000);
       }

       // 4. Harf demonstrasyonuna geç
       function goToLetterDemo() {
           stopCurrentAudio();
           showScreen('letterDemoScreen');
           
           // Harfleri hemen göster
           document.getElementById('letterDisplay').classList.add('visible');
           
           // Eğer daha önce görülmüşse, butonları hemen göster
           if (testState.hasSeenLetter) {
               document.getElementById('letterNextBtn').classList.add('visible');
               startLetterAnimation();
               return;
           }
           
           testState.hasSeenLetter = true;
           
           // örnek2.mp3'ü çal
           playAudio('örnek2.mp3');
           
           // Animasyonu hemen başlat
           startLetterAnimation();
           
           // Ses bitince butonu göster
           testState.currentAudio.addEventListener('ended', () => {
               document.getElementById('letterNextBtn').classList.add('visible');
           });
       }

       // Harf animasyonu (c'lere tıklama) - FAKE CURSOR
       function startLetterAnimation() {
           const cursor = document.getElementById('letterCursor');
           const targets = ['target-c-1', 'target-c-2'];
           let currentTarget = 0;
           let isFirstAnimation = true;
           
           function animateToTarget() {
               const targetElement = document.getElementById(targets[currentTarget]);
               
               if (!targetElement) return;
               
               // Delay hesaplaması
               const delay = isFirstAnimation ? 100 : 0;
               
               // Sadece ilk animasyonda cursor'u başlangıç pozisyonuna getir
               if (isFirstAnimation) {
                   cursor.style.opacity = '1';
                   cursor.style.left = '50px';
                   cursor.style.top = '50px';
                   cursor.style.transition = 'none';
                   isFirstAnimation = false;
               }
               
               // Target element'in pozisyonunu al (parent'a göre)
               const targetRect = targetElement.getBoundingClientRect();
               const parentRect = targetElement.parentElement.getBoundingClientRect();
               
               // Hedef pozisyonunu hesapla
               const targetX = targetRect.left - parentRect.left + (targetElement.offsetWidth / 2) - 10;
               const targetY = targetRect.top - parentRect.top + (targetElement.offsetHeight / 2) - 10;
               
               // Hedefe hareket et
               setTimeout(() => {
                   cursor.style.transition = 'left 1s ease-in-out, top 1s ease-in-out';
                   cursor.style.left = targetX + 'px';
                   cursor.style.top = targetY + 'px';
               }, delay);
               
               // 1.5 saniye sonra tıklama efekti
               setTimeout(() => {
                   targetElement.classList.add('clicked');
                   
                   setTimeout(() => {
                       targetElement.classList.remove('clicked');
                       currentTarget = (currentTarget + 1) % targets.length;
                   }, 1400);
               }, 1500);
           }
           
           animateToTarget();
           testState.animationTimer = setInterval(animateToTarget, 3000);
       }

      // 5. Örnek uygulama geçiş ekranına geç
      function goToExampleTransition() {
          stopCurrentAudio();
          showScreen('exampleTransitionScreen');
          
          // örnekgecis.mp3'ü çal
          playAudio('örnekgecis.mp3');
          
          // Ses bitince ileri butonunu göster
          testState.currentAudio.addEventListener('ended', () => {
              document.getElementById('exampleTransitionBtn').classList.add('visible');
          });
      }

      // 6. Örnek uygulama başlangıç ekranına geç
      function goToExampleStart() {
          stopCurrentAudio();
          showScreen('exampleStartScreen');
          
          // örnekbaşla.mp3'ü çal
          playAudio('örnekbaşla.mp3');
          
          // Ses bitince başla butonunu göster
          testState.currentAudio.addEventListener('ended', () => {
              document.getElementById('exampleStartBtn').classList.add('visible');
          });
      }

      // 5. Pratik testi başlat
      function startPracticeTest() {
          stopCurrentAudio();
          showScreen('practiceTestScreen');
          
          // Pratik test durumunu sıfırla
          testState.practiceIndex = 0;
          testState.practiceAnswers = [];
          testState.practiceTimeLeft = 30;
          testState.practiceStartTime = Date.now();
          
          // Timer'ı başlat
          startPracticeTimer();
          
          // İlk soruyu göster
          showPracticeQuestion();
      }

      // Pratik test timer'ı
      function startPracticeTimer() {
          const totalTime = 30; // 30 saniye
          const progressBar = document.getElementById('practiceProgressBar');
          
          testState.practiceTimer = setInterval(() => {
              testState.practiceTimeLeft--;
              
              // Progress bar'ı güncelle - soldan sağa dolacak şekilde
              const progress = 1 - (testState.practiceTimeLeft / totalTime);
              progressBar.style.transform = `scaleX(${progress})`;
              
              if (testState.practiceTimeLeft <= 0) {
                  endPracticeTest();
              }
          }, 1000);
      }

      // Pratik soru göster
      function showPracticeQuestion() {
          if (testState.practiceIndex >= testData.practiceQuestions.length) {
              endPracticeTest();
              return;
          }

          const question = testData.practiceQuestions[testState.practiceIndex];
          const display = document.getElementById('practiceDisplay');
          
          // Soruyu temizle ve yeniden oluştur
          display.innerHTML = '';
          display.classList.remove('visible');
          
          question.question.forEach((option, index) => {
              const btn = document.createElement('div');
              btn.className = 'option-btn';
              btn.textContent = option;
              btn.onclick = () => selectPracticeAnswer(option, question.target);
              display.appendChild(btn);
          });
          
          // Soruyu göster
          setTimeout(() => {
              display.classList.add('visible');
          }, 300);
      }

      // Pratik cevap seç - SADECE TİKLANAN SEÇİLİ
      function selectPracticeAnswer(selected, correct) {
          // Sadece tıklanan butonu seçili göster
          const buttons = document.querySelectorAll('#practiceDisplay .option-btn');
          buttons.forEach(btn => {
              btn.onclick = null; // Tıklamaları devre dışı bırak
              btn.classList.remove('selected'); // Tüm seçimleri temizle
              if (btn.textContent === selected) {
                  btn.classList.add('selected'); // Sadece tıklananı seç
              }
          });
          
          // Cevabı kaydet
          testState.practiceAnswers.push({
              question: testState.practiceIndex,
              selected: selected,
              correct: correct,
              isCorrect: selected === correct
          });
          
          testState.practiceIndex++;
          
          // Sonraki soruya geç
          setTimeout(() => {
              showPracticeQuestion();
          }, 500);
      }

      // Örnek uygulamayı bitir
      function endPracticeTest() {
          if (testState.practiceTimer) {
              clearInterval(testState.practiceTimer);
          }
          
          // Doğru cevap sayısını hesapla
          const correctCount = testState.practiceAnswers.filter(answer => answer.isCorrect).length;
          
          if (correctCount >= 3) {
              // Başarılı - örnek uygulama tamamlandı ekranına geç
              goToExampleComplete();
          } else {
              // Başarısız - demonstrasyonları sıfırla ve baştan başla
              alert('Örnek uygulamada başarısız oldunuz. 5 soruda en az 3 doğru cevap vermelisiniz. Demonstrasyonları tekrar izleyerek örnek uygulamaya tekrar başlayabilirsiniz.');
              resetDemoStates(); // Demonstrasyon durumlarını sıfırla
              goToIntroDemo(); // Seslerle birlikte baştan başla
          }
      }

      // 7. Örnek uygulama tamamlandı ekranına geç
      function goToExampleComplete() {
          stopCurrentAudio();
          showScreen('exampleCompleteScreen');
          
          // örnekok.mp3'ü çal
          playAudio('örnekok.mp3');
          
          // Ses bitince ileri butonunu göster
          testState.currentAudio.addEventListener('ended', () => {
              document.getElementById('exampleCompleteBtn').classList.add('visible');
          });
      }

      // 8. Ana test hazırlığa geç
      function goToMainTestIntro() {
          stopCurrentAudio();
          showScreen('mainTestIntroScreen');
          
          // testbasla.mp3'ü çal
          playAudio('testbasla.mp3');
          
          // Ses bitince başla butonunu göster
          testState.currentAudio.addEventListener('ended', () => {
              document.getElementById('mainTestIntroBtn').classList.add('visible');
          });
      }

      // 7. Ana testi başlat
      function startMainTest() {
          stopCurrentAudio();
          showScreen('mainTestScreen');
          
          // Ana test durumunu sıfırla
          testState.mainIndex = 0;
          testState.mainAnswers = [];
          testState.mainTimeLeft = 180;
          testState.mainStartTime = Date.now();
          testState.reactionTimes = [];
          
          // Timer'ı başlat
          startMainTimer();
          
          // İlk soruyu göster
          showMainQuestion();
      }

      // Ana test timer'ı
      function startMainTimer() {
          const totalTime = 180; // 3 dakika
          const progressBar = document.getElementById('mainProgressBar');
          
          testState.mainTimer = setInterval(() => {
              testState.mainTimeLeft--;
              
              // Progress bar'ı güncelle - soldan sağa dolacak şekilde
              const progress = 1 - (testState.mainTimeLeft / totalTime);
              progressBar.style.transform = `scaleX(${progress})`;
              
              if (testState.mainTimeLeft <= 0) {
                  endMainTest();
              }
          }, 1000);
      }

      // Ana test soru göster
      function showMainQuestion() {
          if (testState.mainIndex >= testData.mainQuestions.length) {
              endMainTest();
              return;
          }

          const question = testData.mainQuestions[testState.mainIndex];
          const display = document.getElementById('mainDisplay');
          
          // Soruyu temizle ve yeniden oluştur
          display.innerHTML = '';
          display.classList.remove('visible');
          
          question.question.forEach((option, index) => {
              const btn = document.createElement('div');
              btn.className = 'option-btn';
              btn.textContent = option;
              btn.onclick = (event) => selectMainAnswer(event, option, question.target);
              display.appendChild(btn);
          });
          
          // Reaksiyon süresini başlat
          testState.questionStartTime = Date.now();
          
          // Soruyu göster
          setTimeout(() => {
              display.classList.add('visible');
          }, 300);
      }

      // Ana test cevap seç - SADECE TİKLANAN SEÇİLİ
      function selectMainAnswer(event, selected, correct) {
          const reactionTime = Date.now() - testState.questionStartTime;
          testState.reactionTimes.push(reactionTime);
          
          // Sadece tıklanan butonu seçili göster
          const buttons = document.querySelectorAll('#mainDisplay .option-btn');
          buttons.forEach(btn => {
            btn.onclick = null;
            btn.classList.remove('selected');
        });

        event.target.classList.add('selected');
          
          // Cevabı kaydet
          testState.mainAnswers.push({
              question: testState.mainIndex,
              selected: selected,
              correct: correct,
              isCorrect: selected === correct,
              reactionTime: reactionTime
          });
          
          testState.mainIndex++;
          
          // Sonraki soruya geç
          setTimeout(() => {
              showMainQuestion();
          }, 500);
      }

      // Ana testi bitir
      function endMainTest() {
          if (testState.mainTimer) {
              clearInterval(testState.mainTimer);
          }
          
          showScreen('resultsScreen');
          
          // testok.mp3'ü çal
          playAudio('testok.mp3');
      }

      // Form doğrulama ve ilerleme
      function validateAndProceed(event) {
          event.preventDefault();
          
          // Tüm form elemanlarını kontrol et
          const form = document.getElementById('userInfoForm');
          const inputs = form.querySelectorAll('input, select');
          let isValid = true;
          
          inputs.forEach(input => {
              if (!input.value.trim()) {
                  isValid = false;
                  input.nextElementSibling.style.display = 'block';
              } else {
                  input.nextElementSibling.style.display = 'none';
              }
          });
          
          if (isValid) {
              // Form verilerini sakla
              const formData = {
                  firstName: document.getElementById('firstName').value,
                  lastName: document.getElementById('lastName').value,
                  age: document.getElementById('age').value,
                  gender: document.getElementById('gender').value,
                  education: document.getElementById('education').value,
                  email: document.getElementById('email').value
              };
              
              // Form verilerini localStorage'a kaydet
              localStorage.setItem('userTestInfo', JSON.stringify(formData));
              
              // Ses ayarları ekranına geç
              goToSoundSetup();
          }
          
          return false;
      }

      // Sayfa yüklendiğinde
      window.addEventListener('load', function() {
          console.log('ForTest Dikkat Algoritması Test Sistemi Hazır');
      });

             // Test tamamlama fonksiyonu
       function completeTest() {
           // Sıradaki bölüme yönlendirme yapılabilir
           console.log('Test tamamlandı, sıradaki bölüme geçiliyor...');
       }

       // Temizlik fonksiyonu (sayfa kapanırken)
       window.addEventListener('beforeunload', function() {
           stopCurrentAudio();
           
           // Tüm timer'ları temizle
           if (testState.practiceTimer) clearInterval(testState.practiceTimer);
           if (testState.mainTimer) clearInterval(testState.mainTimer);
       });
  </script>
</body>
</html>