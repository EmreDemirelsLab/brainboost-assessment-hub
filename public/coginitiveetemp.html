<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ForBrain Bilişsel Becerileri Değerlendirme Raporu</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script>
        // Wait for Chart.js to load before setting defaults
        window.addEventListener('load', function() {
            if (typeof Chart !== 'undefined') {
                // Global performance optimizations
                Chart.defaults.animation = {
                    duration: 200, // Faster animations
                    easing: 'linear'
                };
                Chart.defaults.responsive = true;
                Chart.defaults.maintainAspectRatio = false;
            }
        });
        
        // Performance-optimized logging system
        const DEBUG_MODE = window.location.hostname === 'localhost' || window.location.search.includes('debug=true');
        
        const logger = {
            log: DEBUG_MODE ? console.log.bind(console) : () => {},
            warn: DEBUG_MODE ? console.warn.bind(console) : () => {},
            error: console.error.bind(console), // Always show errors
            info: DEBUG_MODE ? console.info.bind(console) : () => {}
        };
    </script>
    <style>
        /* Performance optimization: GPU acceleration for animations */
        .page {
            transform: translateZ(0);
            will-change: transform;
        }
        
        /* Optimize chart rendering */
        canvas {
            image-rendering: -webkit-optimize-contrast;
            image-rendering: crisp-edges;
        }
        
        /* Reduce layout shifts */
        .vertical-bar-chart {
            contain: layout style;
        }
        
        /* Loading optimization - Hide content until data is ready */
        body:not(.loaded) .page {
            opacity: 0;
            visibility: hidden;
        }
        
        body.loaded .page {
            opacity: 1;
            visibility: visible;
            transition: opacity 0.3s ease-in-out;
        }
        
        /* Hide hard-coded data initially */
        .info-item span:last-child,
        .skill-analysis .skill-name,
        .skill-analysis .skill-description,
        .bar-value,
        .score-high, .score-medium, .score-low {
            opacity: 0;
            transition: opacity 0.2s ease-in-out;
        }
        
        /* Show data when loaded */
        body.loaded .info-item span:last-child,
        body.loaded .skill-analysis .skill-name,
        body.loaded .skill-analysis .skill-description,
        body.loaded .bar-value,
        body.loaded .score-high, 
        body.loaded .score-medium, 
        body.loaded .score-low {
            opacity: 1;
        }
        
        /* Improved loading overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            font-family: Arial, sans-serif;
        }
        
        .loading-overlay .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #1e40af;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #fff;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }
        
        body.loaded {
            opacity: 1;
        }
        
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            font-family: Arial, sans-serif;
        }
        
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #1e40af;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .page {
            width: 210mm;
            min-height: 297mm;
            margin: 0 auto;
            padding: 20mm;
            background: white;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            page-break-after: always;
            position: relative;
        }

        /* Logo Styles */
        .logo-section {
            text-align: center;
            margin-bottom: 20px;
        }

        .forbrain-logo {
            height: 60px;
            margin-bottom: 10px;
        }

        .main-title {
            font-size: 24px;
            font-weight: bold;
            color: #1e40af;
            text-align: center;
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 18px;
            font-weight: bold;
            color: #1e40af;
            margin: 25px 0 15px 0;
            border-bottom: 2px solid #1e40af;
            padding-bottom: 5px;
        }

        .section-title-green {
            font-size: 18px;
            font-weight: bold;
            color: #28a745;
            margin: 25px 0 15px 0;
            border-bottom: 2px solid #28a745;
            padding-bottom: 5px;
        }

        .section-title-red {
            font-size: 18px;
            font-weight: bold;
            color: #dc3545;
            margin: 25px 0 15px 0;
            border-bottom: 2px solid #dc3545;
            padding-bottom: 5px;
        }

        .description {
            font-size: 12px;
            text-align: justify;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .info-box {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
        }

        .personal-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .info-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }

        .info-label {
            font-weight: bold;
            color: #2c5aa0;
        }

        .skills-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .skills-table th,
        .skills-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }

        .skills-table th {
            background-color: #2c5aa0;
            color: white;
            font-weight: bold;
        }

        .skill-row {
            background-color: #f8f9fa;
        }

        .score-high {
            background-color: #d4edda;
            color: #155724;
            font-weight: bold;
        }

        .score-medium {
            background-color: #fff3cd;
            color: #856404;
            font-weight: bold;
        }

        .score-low {
            background-color: #f8d7da;
            color: #721c24;
            font-weight: bold;
        }

        .legend {
            margin: 20px 0;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 5px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin: 5px 0;
            font-size: 12px;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            margin-right: 10px;
            border-radius: 3px;
        }

        .skill-analysis {
            margin: 25px 0;
            padding: 20px;
            background-color: #f8f9fa;
            border-left: 4px solid #2c5aa0;
        }

        .skill-name {
            font-weight: bold;
            color: #2c5aa0;
            font-size: 20px;
            margin-bottom: 10px;
        }

        .skill-description {
            font-size: 14px;
            line-height: 1.6;
            text-align: justify;
        }

        .goals-list {
            list-style: none;
            padding-left: 0;
        }

        .goals-list li {
            margin: 8px 0;
            padding-left: 20px;
            position: relative;
        }

        .goals-list li:before {
            content: "•";
            color: #2c5aa0;
            font-weight: bold;
            position: absolute;
            left: 0;
        }

        .radar-chart-container {
            width: 100%;
            height: 400px;
            margin: 30px 0;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }
        
        .radar-chart-container canvas {
            display: block !important;
            visibility: visible !important;
            max-width: 400px;
            max-height: 400px;
        }
        
        .chart-container {
            width: 100%;
            height: 300px;
            margin: 20px 0;
            position: relative;
        }
        
        .chart-container canvas {
            display: block !important;
            visibility: visible !important;
            width: 100% !important;
            height: 100% !important;
        }

        /* Minimal Professional Vertical Bar Chart */
        .vertical-bar-chart {
            display: flex;
            justify-content: space-around;
            align-items: end;
            height: 250px;
            margin: 40px 0;
            padding: 30px 20px;
            background: #ffffff;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .bar-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 60px;
        }

        .bar {
            width: 30px;
            background: #6c757d;
            border-radius: 2px 2px 0 0;
            margin-bottom: 10px;
            position: relative;
            transition: all 0.6s ease;
        }

        .bar:hover {
            transform: translateY(-2px);
        }

        .bar-high { background: #28a745; }
        .bar-medium { background: #ffc107; }
        .bar-low { background: #dc3545; }

        .bar-value {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 11px;
            font-weight: bold;
            color: #495057;
        }

        .bar-label {
            font-size: 10px;
            font-weight: 500;
            color: #495057;
            text-align: center;
            line-height: 1.2;
            margin-top: 5px;
        }

        .chart-container {
            width: 100%;
            height: 400px;
            margin: 30px 0;
            position: relative;
        }

        .skill-boxes {
            display: flex;
            justify-content: space-around;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .skill-box {
            background-color: #f8f9fa;
            border: 2px solid #2c5aa0;
            border-radius: 8px;
            padding: 20px;
            margin: 10px;
            text-align: center;
            min-width: 150px;
            flex: 1;
        }

        .skill-box-title {
            font-weight: bold;
            color: #2c5aa0;
            font-size: 14px;
        }

        .profile-name {
            text-align: center;
            color: #2c5aa0;
            font-size: 22px;
            font-weight: bold;
            margin: 20px 0;
        }

        .empty-section {
            min-height: 100px;
            background: #f8f9fa;
            border: 1px dashed #dee2e6;
            margin: 20px 0;
            border-radius: 5px;
            padding: 20px;
            text-align: center;
            color: #6c757d;
        }

        /* Footer Logo */
        .footer-logo {
            position: absolute;
            bottom: 10mm;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
        }

        .footer-logo img {
            height: 25px;
        }

        /* Minimal Professional Vertical Bar Chart */
        .vertical-bar-chart {
            display: flex;
            justify-content: space-around;
            align-items: flex-end;
            height: 300px;
            margin: 40px 0;
            padding: 30px 20px;
            background: #ffffff;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .bar-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 60px;
        }

        .bar {
            width: 30px;
            background: linear-gradient(180deg, #2c5aa0 0%, #1e3d6f 100%);
            border-radius: 4px 4px 0 0;
            transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow: 0 2px 8px rgba(44, 90, 160, 0.2);
            position: relative;
        }

        .bar::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            height: 2px;
            background: #ffffff;
            border-radius: 4px;
        }

        .bar-label {
            margin-top: 10px;
            font-size: 11px;
            font-weight: 600;
            color: #2c5aa0;
            text-align: center;
        }

        .bar-value {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 10px;
            font-weight: bold;
            color: #2c5aa0;
            background: white;
            padding: 2px 6px;
            border-radius: 3px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .chart-container {
            width: 100%;
            height: 300px;
            margin: 30px 0;
            position: relative;
        }

        /* Strong/Weak Areas Styles */
        .strong-weak-areas {
            margin: 30px 0;
        }

        .area-item {
            margin: 15px 0;
            padding: 15px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
        }

        .strong-area {
            background-color: #d4edda;
            color: #155724;
            border-left: 4px solid #28a745;
        }

        .weak-area {
            background-color: #f8d7da;
            color: #721c24;
            border-left: 4px solid #dc3545;
        }

        .medium-area {
            background-color: #fff3cd;
            color: #856404;
            border-left: 4px solid #ffc107;
        }

        /* Recommendation boxes */
        .recommendation-box {
            background-color: #f8f9fa;
            border: 2px solid #2c5aa0;
            border-radius: 8px;
            padding: 30px;
            margin: 20px 0;
            min-height: 200px;
        }

        .recommendation-title {
            font-size: 18px;
            font-weight: bold;
            color: #2c5aa0;
            margin-bottom: 15px;
            text-align: center;
        }

        .recommendation-content {
            font-size: 14px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }

        /* Observer notes box */
        .observer-box {
            background-color: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 30px;
            margin: 20px 0;
            min-height: 150px;
        }

        @media print {
            .page {
                margin: 0;
                box-shadow: none;
                page-break-after: always;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <div style="color: #1e40af; font-weight: bold;">Rapor yükleniyor...</div>
    </div>
    
    <!-- SAYFA 1 -->
    <div class="page">
        <div class="logo-section">
            <img src="public/assets/images/forbrain logo.png" alt="ForBrain Logo" class="forbrain-logo">
        </div>

        <div class="main-title">ForBrain Bilişsel Becerileri<br>Değerlendirme Raporu</div>

        <div class="info-box">
            <div class="personal-info">
                <div>
                    <div class="info-item">
                        <span class="info-label">Ad Soyad</span>
                        <span>Ece Yeşim Cinemre</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Cinsiyet</span>
                        <span>Kadın</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Yaş</span>
                        <span>31 Yıl 7 Ay 11 Gün</span>
                    </div>
                </div>
                <div>
                    <div class="info-item">
                        <span class="info-label">Doğum Tarihi</span>
                        <span>16/12/1994</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Değerlendirme Tarihi</span>
                        <span>11/07/2025</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Uygulayan</span>
                        <span>Funda Demirel</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="section-title">Bilişsel Beceriler Performans Grafiği</div>

        <table class="skills-table">
            <thead>
                <tr>
                    <th>Beceri Kategorisi</th>
                    <th>Beceri Tanımı</th>
                    <th>Yüzdelik Skor</th>
                </tr>
            </thead>
            <tbody>
                <tr class="skill-row">
                    <td><strong>Dikkat</strong></td>
                    <td>Amaca uygun bilgiyi seçme, zihinsel kaynakları bu bilgiye yönlendirme ve odağı sürdürebilme becerisidir.</td>
                    <td class="score-high">%81</td>
                </tr>
                <tr class="skill-row">
                    <td><strong>Hafıza</strong></td>
                    <td>Bilgilerin kodlanması, saklanması ve gerektiğinde kullanma becerisidir.</td>
                    <td class="score-medium">%68</td>
                </tr>
                <tr class="skill-row">
                    <td><strong>İşleme Hızı</strong></td>
                    <td>Bilgiyi algılama, değerlendirme ve yanıt verme hızıdır.</td>
                    <td class="score-high">%89</td>
                </tr>
                <tr class="skill-row">
                    <td><strong>Görsel İşleme</strong></td>
                    <td>Görsel bilgiyi tanıma, analiz etme ve anlamlandırma becerisidir.</td>
                    <td class="score-low">%32</td>
                </tr>
                <tr class="skill-row">
                    <td><strong>Akıl ve Mantık Yürütme</strong></td>
                    <td>Bilgiyi kullanarak çıkarım yapma, problem çözme ve sonuç üretme becerisidir.</td>
                    <td class="score-low">%17</td>
                </tr>
                <tr class="skill-row">
                    <td><strong>Bilişsel Esneklik</strong></td>
                    <td>Düşünce biçimini ya da davranışını değişen durumlara göre uyarlayabilme becerisidir.</td>
                    <td class="score-medium">%57</td>
                </tr>
            </tbody>
        </table>

        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background-color: #d4edda;"></div>
                <span><strong>%75 üzeri:</strong> Bilişsel becerileri geliştirme uygulamaları isteğe bağlı bireysel hedeflere göre planlanabilir.</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #fff3cd;"></div>
                <span><strong>%51-75:</strong> Bilişsel becerileri geliştirme uygulamaları bireyin hedeflerine göre öncelikli olmalıdır.</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #f8d7da;"></div>
                <span><strong>%25-50:</strong> Bilişsel becerileri geliştirme uygulamalarına ihtiyaç vardır. Bireyin performansı artırılmalıdır.</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #dc3545;"></div>
                <span><strong>%25 altı:</strong> Bilişsel becerileri geliştirme uygulamalarına kesinlikle ihtiyacı vardır.</span>
            </div>
        </div>

        <div class="section-title">Bilişsel Performansın Yüzdelik Analizi</div>
        <div class="description">
            Bilişsel beceri profili çıkaran bu sistemde bireyin performansı yüzdelik dilimler üzerinden değerlendirilmektedir. Sistem, her bir bilişsel beceri alanını 100 üzerinden puanlayarak bu ham puanları daha sonra yüzdelik dilimlere dönüştürmektedir. Temel referans olarak belirlenen yüzdelik dilimler (%25'in altı, %25-50, %50-75 ve %75 üzeri) bireyin beceri düzeyini norm tabanlı sınıflandırmaktadır.
        </div>

        <div class="description">
            Bu sistemin amacı bireyin bilişsel gelişim sürecindeki güçlü ve gelişmesi gereken yönlerini objektif verilerle ortaya koymak, potansiyelini kullanmasını engelleyen beceri alanlarını tespit etmek ve buna uygun kişiye özel gelişim planı oluşturmaktır.
        </div>

        <div class="section-title">Öğrenmenin Temeli: Bilişsel Beceriler</div>
        <div class="description">
            Bilişsel beceriler, öğrenmenin temelini oluşturan zihinsel süreçlerdir. Her bireyin bu becerilerdeki performansı farklılık gösterebilir.
        </div>

        <div class="description">
            Gelişime açık olan beceriler öğrenme sürecini yavaşlatabilir veya zorlaştırabilir. Güçlü bilişsel beceriler öğrenmeyi daha hızlı, verimli ve kolay hale getirebilir.
        </div>

        <div class="description">
            Bireyin bir ya da birden fazla bilişsel becerisi zayıf olabilir; ancak bu beceriler yapılandırılmış programlarla geliştirilebilir ve böylece bireyin gerçek potansiyeli açığa çıkabilir.
        </div>

        <div class="description">
            ForBrain Bilişsel Becerileri Değerlendirme Raporu'nun temel amacı, bireyin öğrenme sürecini olumsuz etkileyen bilişsel alanları belirleyerek kişiye özel bir gelişim planı sunmaktır.
        </div>

        <div class="footer-logo">
            <img src="public/assets/images/logo.png" alt="Logo">
        </div>
    </div>

    <!-- SAYFA 2 -->
    <div class="page">
        <div class="logo-section">
            <img src="public/assets/images/forbrain logo.png" alt="ForBrain Logo" class="forbrain-logo">
        </div>

        <div class="main-title">ForBrain Bilişsel Becerileri<br>Değerlendirme Raporu</div>

        <div class="section-title">Gelişim Odaklı Bir Yaklaşım</div>
        <div class="description">
            ForBrain Bilişsel Becerileri Değerlendirme Sistemi, tanı koymak ya da bireyin genel öğrenme kapasitesini etiketlemek amacıyla kullanılmaz. Bu sistem, bireyin öğrenme sürecini zorlaştıran bilişsel becerileri belirlemek ve gelişime açık alanları tespit etmek için değerlendirilir.
        </div>

        <div class="description">
            Test sonuçları; bireyin dikkat durumu, test anındaki fiziksel koşulları (örneğin stres, yorgunluk), dijital araçları kullanma becerisi (örneğin fare kullanımı, işitsel algı) gibi dış etkenlerden etkilenebilir. Bu nedenle test ortamı ve bireyin katılım durumu dikkate alınarak değerlendirilmelidir.
        </div>

        <div class="section-title">Her Beceriyi Ayrı Ayrı Değerlendiren Sistematik Yaklaşım</div>
        <div class="description">
            ForBrain Bilişsel Becerileri Değerlendirme Sistemi öğrenme için kritik olan temel bilişsel becerileri ayrı ayrı değerlendirerek; bireyin performans düşüklüğüne neyin sebep olabileceğini açıkça ortaya koyar. Bu sayede gelişim odaklı ve kişiye özel programlar oluşturmak mümkün hale gelir.
        </div>

        <div class="section-title">ForBrain Bilişsel Becerileri Değerlendirme Raporunun Hedefleri</div>
        <div class="description">ForBrain Değerlendirme Sistemi şu hedeflere hizmet eder:</div>
        <ul class="goals-list">
            <li>Bireyin bilişsel olarak güçlü ve gelişime açık yönlerini belirlemek</li>
            <li>Öğrenme zorluklarının nedenlerini analiz etmek</li>
            <li>Süreç içerisinde bilişsel gelişimi izlemek ve ilerlemeyi ölçmek</li>
            <li>Kişiye özel yapılandırılmış gelişim planı hazırlamak</li>
            <li>Akademik ve günlük hayatta zihinsel performansı desteklemek</li>
            <li>Bireyin potansiyelini açığa çıkararak yaşam boyu başarılı seçimlerini desteklemek</li>
        </ul>

        <!-- Minimal Professional Dikey Bar Chart -->
        <div class="vertical-bar-chart">
            <div class="bar-item">
                <div class="bar bar-high" style="height: 0px;" data-height="162">
                    <div class="bar-value">%81</div>
                </div>
                <div class="bar-label">Dikkat</div>
            </div>
            <div class="bar-item">
                <div class="bar bar-medium" style="height: 0px;" data-height="136">
                    <div class="bar-value">%68</div>
                </div>
                <div class="bar-label">Hafıza</div>
            </div>
            <div class="bar-item">
                <div class="bar bar-high" style="height: 0px;" data-height="178">
                    <div class="bar-value">%89</div>
                </div>
                <div class="bar-label">İşleme<br>Hızı</div>
            </div>
            <div class="bar-item">
                <div class="bar bar-low" style="height: 0px;" data-height="34">
                    <div class="bar-value">%17</div>
                </div>
                <div class="bar-label">Görsel<br>İşleme</div>
            </div>
            <div class="bar-item">
                <div class="bar bar-low" style="height: 0px;" data-height="64">
                    <div class="bar-value">%32</div>
                </div>
                <div class="bar-label">Akıl ve<br>Mantık<br>Yürütme</div>
            </div>
            <div class="bar-item">
                <div class="bar bar-medium" style="height: 0px;" data-height="114">
                    <div class="bar-value">%57</div>
                </div>
                <div class="bar-label">Bilişsel<br>Esneklik</div>
            </div>
        </div>

        <div class="footer-logo">
            <img src="public/assets/images/logo.png" alt="Logo">
        </div>
    </div>

    <!-- SAYFA 3 -->
    <div class="page">
        <div class="logo-section">
            <img src="public/assets/images/forbrain logo.png" alt="ForBrain Logo" class="forbrain-logo">
        </div>

        <div class="main-title">ForBrain Bilişsel Becerileri<br>Değerlendirme Raporu</div>

        <div class="section-title">Bilişsel Olarak Güçlü ve Gelişime Açık Alanlar</div>

        <div class="skill-analysis">
            <div class="skill-name">Dikkat ve Odaklanma Skoru: % 81</div>
            <div class="skill-description">
                Dikkatini sürdürme ve göreve odaklanma becerisi oldukça güçlüdür. Hedefe yoğunlaşma, yönerge takibi ve ayrıntı fark etme gibi becerilerde etkin performans sergilemektedir.
            </div>
        </div>

        <div class="skill-analysis">
            <div class="skill-name">Hafıza Skoru: % 68</div>
            <div class="skill-description">
                Bilgiyi kodlama ve gerektiğinde geri çağırma becerisi gelişmiş durumdadır. Yapılandırılmış görevlerde ve tekrar içeren çalışmalarda bu beceriden işlevsel şekilde faydalanabilir. Ancak bilgi yükü arttığında veya dikkat dağıldığında hafıza ve öğrenme olumsuz etkilenebilir.
            </div>
        </div>

        <div class="skill-analysis">
            <div class="skill-name">İşleme Hızı Skoru: % 89</div>
            <div class="skill-description">
                İşleme hızı becerisi güçlüdür. Bilgiyi hızlı algılar, anlamlandırır ve uygun tepkileri zamanında verir. Bu beceri yönergeleri çabuk kavrama, görevleri süresinde tamamlama ve akademik hız gerektiren durumlarda avantaj sağlar. Günlük işlerin akıcı ve düzenli şekilde yürütülmesine katkı sunar.
            </div>
        </div>

        <div class="skill-analysis">
            <div class="skill-name">Görsel İşleme Skoru: % 32</div>
            <div class="skill-description">
                Görsel İşleme becerisi sınırlı düzeydedir. Görsel bilgileri tanıma, karşılaştırma ve anlamlandırma süreçlerinde zorluklar yaşanabilir. Harf, sayı veya şekilleri birbirinden ayırt etmekte güçlük görülebilir. Bu durum, okuma yazma gibi akademik becerilerde ya da yön bulma, nesne tanıma gibi günlük işlevlerde aksamalar yaratabilir.
            </div>
        </div>

        <div class="skill-analysis">
            <div class="skill-name">Akıl ve Mantık Yürütme Skoru: % 17</div>
            <div class="skill-description">
                Akıl ve mantık yürütme becerisi geliştirilmesi gereken öncelikli bir alandır. Bilgileri karşılaştırma, neden-sonuç ilişkisi kurma, problem çözme ve çıkarım yapma süreçlerinde belirgin zorluklar yaşanabilir. Bu durum çok adımlı akıl yürütme gerektiren akademik performansları olumsuz etkileyebilir.
            </div>
        </div>

        <div class="skill-analysis">
            <div class="skill-name">Bilişsel Esneklik Skoru: % 57</div>
            <div class="skill-description">
                Bilişsel esneklik becerisi temel düzeydedir. Görev sırasında değişen kurallara genellikle uyum sağlanır. Yönergeleri ayırt etme ve uygun strateji seçme konusunda zaman zaman tereddüt yaşanabilir. Bu durum özellikle çok adımlı görevlerde ve hızlı uyum gerektiren durumlarda ek destek ihtiyacını artırabilir.
            </div>
        </div>

        <div class="radar-chart-container">
            <canvas id="radarChart" width="400" height="400"></canvas>
        </div>

        <div class="footer-logo">
            <img src="public/assets/images/logo.png" alt="Logo">
        </div>
    </div>

    <!-- SAYFA 4 -->
    <div class="page">
        <div class="logo-section">
            <img src="public/assets/images/forbrain logo.png" alt="ForBrain Logo" class="forbrain-logo">
        </div>

        <div class="main-title">ForBrain Bilişsel Becerileri<br>Değerlendirme Raporu</div>

        <div class="section-title-green">Bilişsel Becerileri Geliştirme Önerileri</div>

        <div class="recommendation-box">
            <div class="recommendation-title">Dikkat</div>
            <div class="recommendation-content">
                Dikkat becerileriniz oldukça güçlü seviyededir. Bu güçlü yanınızı korumak için düzenli mental egzersizler yapabilir, meditasyon tekniklerini uygulayabilir ve odaklanma gerektiren aktivitelere devam edebilirsiniz. Dikkat sürenizi daha da artırmak için pomodoro tekniği gibi zaman yönetimi stratejilerini kullanabilirsiniz.
            </div>
        </div>

        <div class="recommendation-box">
            <div class="recommendation-title">Hafıza</div>
            <div class="recommendation-content">
                Hafıza becerileriniz iyi seviyededir ancak daha da geliştirilebilir. Hafıza tekniklerini öğrenebilir, düzenli tekrar stratejileri uygulayabilir ve görsel-işitsel öğrenme yöntemlerini kullanabilirsiniz. Hafıza sarayı tekniği, akılda kalıcılığı artırmak için etkili bir yöntemdir.
            </div>
        </div>

        <div class="recommendation-box">
            <div class="recommendation-title">İşleme Hızı</div>
            <div class="recommendation-content">
                İşleme hızınız çok güçlü bir alandır. Bu avantajınızı korumak için hızlı karar verme gerektiren aktiviteler yapabilir, zihinsel çeviklik oyunları oynayabilir ve multitasking becerilerinizi geliştirebilirsiniz. Ancak hızla birlikte doğruluğu da korumanız önemlidir.
            </div>
        </div>

        <div class="footer-logo">
            <img src="public/assets/images/logo.png" alt="Logo">
        </div>
    </div>

    <!-- SAYFA 5 -->
    <div class="page">
        <div class="logo-section">
            <img src="public/assets/images/forbrain logo.png" alt="ForBrain Logo" class="forbrain-logo">
        </div>

        <div class="main-title">ForBrain Bilişsel Becerileri<br>Değerlendirme Raporu</div>

        <div class="section-title-green">Bilişsel Becerileri Geliştirme Önerileri</div>

        <div class="recommendation-box">
            <div class="recommendation-title">Görsel İşleme</div>
            <div class="recommendation-content">
                Görsel işleme beceriniz geliştirilmesi gereken bir alandır. Görsel algı egzersizleri, puzzle çözme, şekil tanıma oyunları ve görsel-uzamsal aktiviteler yapabilirsiniz. Çizim, boyama ve görsel sanatlarla uğraşmak bu beceriyi geliştirmeye yardımcı olacaktır. Düzenli göz egzersizleri de faydalı olabilir.
            </div>
        </div>

        <div class="recommendation-box">
            <div class="recommendation-title">Akıl ve Mantık Yürütme</div>
            <div class="recommendation-content">
                Bu alan en çok geliştirilmesi gereken beceri alanınızdır. Mantık oyunları, sudoku, satranç gibi stratejik oyunlar oynayabilirsiniz. Problem çözme tekniklerini öğrenebilir, analitik düşünme egzersizleri yapabilir ve neden-sonuç ilişkilerini güçlendiren aktivitelere odaklanabilirsiniz.
            </div>
        </div>

        <div class="recommendation-box">
            <div class="recommendation-title">Bilişsel Esneklik</div>
            <div class="recommendation-content">
                Bilişsel esneklik beceriniz orta seviyededir ve geliştirilebilir. Farklı bakış açıları geliştirme egzersizleri, yaratıcılık aktiviteleri ve esneklik gerektiren oyunlar oynayabilirsiniz. Rutin değişiklikler yaparak adaptasyon becerinizi geliştirebilir ve çoklu görev yönetimi pratikleri yapabilirsiniz.
            </div>
        </div>

        <div class="footer-logo">
            <img src="public/assets/images/logo.png" alt="Logo">
        </div>
    </div>

    <!-- SAYFA 6 -->
    <div class="page">
        <div class="logo-section">
            <img src="public/assets/images/forbrain logo.png" alt="ForBrain Logo" class="forbrain-logo">
        </div>

        <div class="main-title">ForBrain Bilişsel Becerileri<br>Değerlendirme Raporu</div>

        <div class="section-title-red">Bilişsel Becerileri Geliştirme Önerileri</div>

        <div class="chart-container">
            <canvas id="barChart"></canvas>
        </div>

        <div class="section-title">Beyin Antrenörü Gözlem ve Görüşleri</div>
        
        <div class="observer-box">
            <div class="recommendation-content">
                Bu alan beyin antrenörünün gözlem ve değerlendirmelerini içermektedir. Bireysel görüşme notları, test sırasındaki davranış gözlemleri ve özel öneriler bu bölümde yer alacaktır.
            </div>
        </div>

        <div class="footer-logo">
            <img src="public/assets/images/logo.png" alt="Logo">
        </div>
    </div>

    <script>
        // Modern Vertical Bar Chart Animation
        function animateVerticalBars() {
            const bars = document.querySelectorAll('.bar');
            bars.forEach((bar, index) => {
                setTimeout(() => {
                    const targetHeight = bar.getAttribute('data-height');
                    bar.style.height = targetHeight + 'px';
                }, index * 200);
            });
        }

        // OLD RADAR CHART FUNCTION REMOVED - Using clean version below

        // Bar Chart - Son sayfadaki grafik
        // NOTE: This simple template chart conflicts with the dynamic chart below.
        // It is kept but will be guarded by a global destroy mechanism.
        // REFERENCE-BASED WORKING BAR CHART
        function createBarChart() {
            const ctx = document.getElementById('barChart');
            if (!ctx) return;

            // Simple destroy
            try { Chart.getChart(ctx)?.destroy(); } catch(e) {}

            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12'],
                    datasets: [
                        {
                            label: '',
                            data: [48, 35, 45, 40, 65, 52, 45, 40, 44, 64, 42, 55],
                            backgroundColor: 'rgba(231, 76, 60, 0.8)',
                            borderColor: 'rgba(231, 76, 60, 1)',
                            borderWidth: 1
                        },
                        {
                            label: '',
                            data: [25, 18, 22, 15, 8, 12, 25, 28, 20, 15, 25, 18],
                            backgroundColor: 'rgba(52, 73, 94, 0.8)',
                            borderColor: 'rgba(52, 73, 94, 1)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            enabled: true,
                            backgroundColor: 'rgba(0,0,0,0.8)',
                            titleColor: '#fff',
                            bodyColor: '#fff',
                            borderColor: 'rgba(52, 73, 94, 1)',
                            borderWidth: 1,
                            displayColors: true,
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (context.datasetIndex === 0) {
                                        label = 'Kırmızı';
                                    } else if (context.datasetIndex === 1) {
                                        label = 'Mavi';
                                    }
                                    return label + ': ' + context.parsed.y;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                stepSize: 20
                            },
                            grid: {
                                color: '#E0E0E0'
                            }
                        }
                    }
                }
            });
        }

        // Initialize charts when page loads
        function initializeCharts() {
            console.log('🚀 initializeCharts called');
            console.log('🔍 Chart.js status:', typeof Chart);
            console.log('🔍 DOM ready state:', document.readyState);
            
            // Wait for Chart.js to be fully loaded
            if (typeof Chart === 'undefined') {
                console.error('❌ Chart.js not loaded! Retrying in 500ms...');
                logger.error('❌ Chart.js not loaded!');
                setTimeout(initializeCharts, 500);
                return;
            }
            
            console.log('✅ Chart.js loaded successfully');
            logger.log('✅ Chart.js loaded successfully');
            
            // Check if canvas elements exist
            const radarCanvas = document.getElementById('radarChart');
            const barCanvas = document.getElementById('barChart');
            
            console.log('🔍 Radar canvas exists:', !!radarCanvas);
            console.log('🔍 Bar canvas exists:', !!barCanvas);
            
            if (!radarCanvas || !barCanvas) {
                console.warn('⚠️ Canvas elements not found, retrying in 200ms...');
                setTimeout(initializeCharts, 200);
                return;
            }
            
            // Initial template-only render guarded with destroy to avoid reuse errors
            console.log('📊 Initializing template charts...');
            logger.log('📊 Initializing template charts...');
            
            try {
                createBarChart();
                createRadarChart();
                animateVerticalBars();
                console.log('✅ All charts initialized successfully');
            } catch (error) {
                console.error('❌ Error initializing charts:', error);
            }
        }

        // TEST INITIALIZATION WITH DELAY
        window.addEventListener('load', function() {
            console.log('🔍 Window loaded, checking Chart.js...');
            console.log('🔍 Chart.js type:', typeof Chart);
            
            if (typeof Chart === 'undefined') {
                console.error('❌ Chart.js is NOT loaded!');
                // Try to load it manually
                const script = document.createElement('script');
                script.src = 'https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js';
                script.onload = function() {
                    console.log('✅ Chart.js loaded manually');
                    setTimeout(initCharts, 500);
                };
                document.head.appendChild(script);
            } else {
                console.log('✅ Chart.js is loaded');
                setTimeout(initCharts, 500);
            }
        });
        
        function initCharts() {
            console.log('📊 Initializing charts...');
            
            // Test if we can create a simple chart first
            try {
                const testCanvas = document.getElementById('radarChart');
                if (testCanvas) {
                    console.log('🔍 Test canvas found:', testCanvas);
                    
                    // Destroy any existing
                    const existing = Chart.getChart(testCanvas);
                    if (existing) {
                        console.log('🔄 Destroying existing chart');
                        existing.destroy();
                    }
                    
                    // Create simple test chart
                    console.log('📊 Creating test radar chart...');
                    const testChart = new Chart(testCanvas, {
                        type: 'radar',
                        data: {
                            labels: ['A', 'B', 'C', 'D', 'E', 'F'],
                            datasets: [{
                                label: 'Test',
                                data: [65, 59, 90, 81, 56, 55],
                                borderColor: 'rgb(255, 99, 132)',
                                backgroundColor: 'rgba(255, 99, 132, 0.2)'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false
                        }
                    });
                    console.log('✅ Test chart created:', testChart);
                }
                
                // Now try our functions
                setTimeout(() => {
                    console.log('📊 Creating actual charts...');
                    createBarChart();
                    createRadarChart();
                    animateVerticalBars();
                }, 1000);
                
            } catch (error) {
                console.error('❌ Chart creation error:', error);
                console.error('Stack:', error.stack);
            }
        }
    </script>



    <script>
        // Cognitive Test Data Management
        let cognitiveData = {
            student: {
                name: 'Yükleniyor...',
                gender: 'Belirtilmemiş',
                age: '0 Yıl 0 Ay 0 Gün',
                birthDate: '01/01/1990',
                evaluationDate: 'Yükleniyor...',
                evaluator: 'Sistem'
            },
            scores: {
                dikkat_skoru: 0,
                hafiza_skoru: 0,
                isleme_hizi_skoru: 0,
                gorsel_isleme_skoru: 0,
                akil_mantik_yurutme_skoru: 0,
                bilissel_esneklik_skoru: 0
            }
        };

        // Chart instances for proper cleanup
        let barChartInstance = null;
        let radarChartInstance = null;

        // Global init guard for Vite HMR / multiple inits
        if (!window.__cogInitDone__) {
            window.__cogInitDone__ = true;
        }

        // Score range mappings from actual images provided by user
        // Dynamic score ranges - will be populated from database
        let scoreRanges = {
            dikkat_skoru: {
                ranges: [
                    { min: 75, max: 100, level: 'Güçlü', description: 'Dikkat ve Odaklanma Becerisi Güçlüdür. Dikkatini sürdürme ve göreve odaklanma becerisi oldukça güçlüdür. Hedefe yoğunlaşma, yönerge takibi ve ayrıntı fark etme gibi becerilerde etkin performans sergilemektedir.' },
                    { min: 51, max: 74, level: 'Gelişmiş', description: 'Dikkat ve Odaklanma Becerisi Gelişmiştir. Dikkatini sürdürebilme becerisi gelişmiş durumdadır. Uygun ve sakin bir ortamda, net yönergelerle verilen görevlerde dikkatini koruyabilir. Ancak odaklanmanın uzun süreli olması için zaman zaman destek ve yönlendirme gerekebilir.' },
                    { min: 25, max: 50, level: 'Sınırlı', description: 'Dikkat ve Odaklanma Becerisi Sınırlı Düzeydedir. Dikkatini sürdürmede ve bilgiye odaklanmada güçlük yaşayabilir. Özellikle çevredeki dikkat dağıtıcılara karşı duyarlılığı dikkat süresini kısaltabilir. Görevleri tamamlamada zorlanmamak için yapılandırılmış bilişsel becerileri geliştirme uygulamaları ile desteklenmelidir.' },
                    { min: 0, max: 24, level: 'Gelişim Öncelikli', description: 'Dikkat ve Odaklanma Becerisi Gelişimi Önceliklidir. Dikkatini toplamakta ve sürdürmekte belirgin güçlük yaşadığı gözlemlenmektedir. Bu durum, öğrenme ve görev takibi süreçlerini olumsuz etkileyebilir. Ayrıntı fark etme, yönergeye uyma, dikkat ve odaklanma becerilerinin gelişimi desteklenmelidir.' }
                ]
            },
            hafiza_skoru: {
                ranges: [
                    { min: 75, max: 100, level: 'Güçlü', description: 'Hafıza Becerisi Güçlüdür. Bilgiyi akılda tutma, gerektiğinde hatırlama ve görevler sırasında doğru şekilde kullanma becerisi oldukça güçlüdür. Öğrenme süreçlerinde hafıza becerileri etkin biçimde kullanılmaktadır.' },
                    { min: 51, max: 74, level: 'Gelişmiş', description: 'Hafıza Becerisi Gelişmiştir. Bilgiyi kodlama ve gerektiğinde geri çağırma becerisi gelişmiş durumdadır. Yapılandırılmış görevlerde ve tekrar içeren çalışmalarda bu beceriden işlevsel şekilde faydalanabilir. Ancak bilgi yükü arttığında veya dikkat dağıldığında hafıza ve öğrenme olumsuz etkilenebilir.' },
                    { min: 25, max: 50, level: 'Sınırlı', description: 'Hafıza Becerisi Sınırlı Düzeydedir. Bilgiyi akılda tutma ve gerektiğinde hatırlama süreçlerinde zorlanabilir. Özellikle dikkat gerektiren görevlerde bilgi hatırlamada güçlük yaşayabilir.' },
                    { min: 0, max: 24, level: 'Gelişim Öncelikli', description: 'Hafıza Becerisi Gelişimi Önceliklidir. Bilgiyi geçici olarak akılda tutma ve görev sırasında kullanma becerilerinde belirgin güçlük yaşadığı gözlemlenmektedir. Bu durum, yönergeleri izleme ve öğrenilen bilgiyi kullanma süreçlerini olumsuz etkileyebilir.' }
                ]
            },
            isleme_hizi_skoru: {
                ranges: [
                    { min: 75, max: 100, level: 'Güçlü', description: 'İşlem Hızı Becerisi Güçlüdür. Bilgiyi algılama, anlamlandırma ve tepki verme sürecini etkili ve hızlı bir şekilde yürütebilmektedir. Bu beceri, yönergeleri çabuk kavrama ve görevleri zamanında tamamlama açısından önemli bir avantaj sağlamaktadır.' },
                    { min: 51, max: 74, level: 'Gelişmiş', description: 'İşlem Hızı Becerisi Gelişmiştir. Bilgiyi anlama ve tepki verme süresi genellikle yeterli hızdadır. Verilen görevlerin karmaşıklığına ve süre sınırlılığına göre işlem hızında zaman zaman değişkenlik gözlenebilir.' },
                    { min: 25, max: 50, level: 'Sınırlı', description: 'İşlem Hızı Becerisi Sınırlı Düzeydedir. Bilgiyi anlamlandırma ve tepkiye dönüştürme süresi zaman zaman uzayabilir. Özellikle hızlı karar verme veya hızlı uygulama gerektiren görevlerde zorlanabilir.' },
                    { min: 0, max: 24, level: 'Gelişim Öncelikli', description: 'İşlem Hızı Becerisi Gelişimi Önceliklidir. Bilgiyi işleme ve tepki verme hızında belirgin yavaşlık görülebilir. Bu durum yönerge takibi, karar verme ve görev tamamlama süreçlerini olumsuz etkileyebilir.' }
                ]
            },
            gorsel_isleme_skoru: {
                ranges: [
                    { min: 75, max: 100, level: 'Güçlü', description: 'Görsel İşleme Becerisi Güçlüdür. Görsel bilgileri tanıma, ayırt etme ve anlamlandırma becerileri güçlüdür. Bu beceri görsel bilgi ağırlıklı görevlerde hızlı ve doğru tepkiler vermesini kolaylaştırmaktadır.' },
                    { min: 51, max: 74, level: 'Gelişmiş', description: 'Görsel İşleme Becerisi Gelişmiştir. Görsel bilgileri tanıma ve ayırt etme becerisi büyük ölçüde gelişmiştir. Ancak benzer şekiller veya yoğun görsel içerikler karşısında ayırt etme ve doğru tepki verme süresi uzayabilir.' },
                    { min: 25, max: 50, level: 'Sınırlı', description: 'Görsel İşleme Becerisi Sınırlı Düzeydedir. Görsel bilgileri tanıma, karşılaştırma ve ayırt etme süreçlerinde güçlük yaşayabilir. Bu durum; harf, sayı ve şekilleri ayırt etmeyi gerektiren görevlerde, özellikle okuma, yazma ve yön bulma gibi alanlarda zorlanmaya neden olabilir.' },
                    { min: 0, max: 24, level: 'Gelişim Öncelikli', description: 'Görsel İşleme Becerisi Gelişimi Önceliklidir. Görsel bilgileri algılama, karşılaştırma ve ayırt etme süreçlerinde belirgin zorlanmalar gözlenmiştir. Bu durum, okuma-yazma gibi akademik alanlarda ve görsel bilgiyi kullanmayı gerektiren günlük görevlerde güçlük yaşanmasına neden olabilir.' }
                ]
            },
            akil_mantik_yurutme_skoru: {
                ranges: [
                    { min: 75, max: 100, level: 'Güçlü', description: 'Akıl ve Mantık Yürütme Becerisi Güçlüdür. Bilgiler arasında ilişki kurma, çıkarım yapma ve problem çözme gibi bilişsel süreçlerde etkili performans sergilemektedir.' },
                    { min: 51, max: 74, level: 'Gelişmiş', description: 'Akıl ve Mantık Yürütme Becerisi Gelişmiştir. Uygun yönlendirme ve yapılandırılmış görevlerle problem çözme ve çıkarım yapma süreçlerini sürdürebilir. Ancak çok adımlı akıl yürütme gerektiren durumlarda zorlanmalar görülebilir.' },
                    { min: 25, max: 50, level: 'Sınırlı', description: 'Akıl ve Mantık Yürütme Becerisi Sınırlı Düzeydedir. Bilgileri karşılaştırma, çıkarım yapma ve neden-sonuç ilişkisi kurma gibi süreçlerde güçlük yaşayabilir. Edinilen bilgileri organize etme, anlamlı bir yapı içinde birleştirme ve farklı durumlara uyarlamada zorlanabilir.' },
                    { min: 0, max: 24, level: 'Gelişim Öncelikli', description: 'Akıl ve Mantık Yürütme Becerisi Gelişimi Önceliklidir. Bilgileri karşılaştırma, neden-sonuç ilişkisi kurma, problem çözme ve çıkarım yapma süreçlerinde belirgin zorluklar yaşayabilir. Bu durum çok adımlı akıl yürütme gerektiren akademik performansları olumsuz etkileyebilir.' }
                ]
            },
            bilissel_esneklik_skoru: {
                ranges: [
                    { min: 75, max: 100, level: 'Güçlü', description: 'Bilişsel Esneklik Becerisi Güçlüdür. Kurallar değiştiğinde ya da görev yapısı farklılaştığında hızla uyum sağlayabilir ve uygun stratejileri seçebilir. Bu beceri, problem çözme ve çok yönlü düşünme gerektiren durumlarda önemli bir avantaj sağlar.' },
                    { min: 51, max: 74, level: 'Gelişmiş', description: 'Bilişsel Esneklik Becerisi Gelişmiştir. Kurallarda değişiklik olduğunda yeni duruma uyum sağlamakta zaman zaman gecikmeler yaşanabilir. Bu durum, özellikle çok adımlı ve değişken görevlerde uyum sürecini zorlaştırabilir.' },
                    { min: 25, max: 50, level: 'Sınırlı', description: 'Bilişsel Esneklik Becerisi Sınırlı Düzeydedir. Kurallarda değişiklik olduğunda yeni duruma uyum sağlamakta güçlük yaşayabilir. Yönergeleri ayırt ederek uygun stratejiyi belirlemekte zorlanabilir. Bu durum özellikle çok adımlı görevlerde ve farklı bakış açıları geliştirilmesi gereken durumlarda bilişsel performansı olumsuz etkileyebilir.' },
                    { min: 0, max: 24, level: 'Gelişim Öncelikli', description: 'Bilişsel Esneklik Becerisi Gelişimi Önceriklidir. Kurallar değiştiğinde eski yönteme takılı kalma, yeni kuralları ayırt edememe ve yönergeler arasında geçiş yapamama gibi belirgin zorlanmalar görülebilir. Bu durum problem çözme, değişen koşullara uyum sağlama ve çok yönlü düşünme gerektiren akademik becerileri olumsuz etkileyebilir.' }
                ]
            }
        };

        // Detailed recommendations from öneri.md file
        // Dynamic detailed recommendations - will be populated from database
        let detailedRecommendations = {
            dikkat_skoru: {
                ranges: [
                    { min: 75, max: 100, recommendations: [
                        'Dikkat becerisi güçlü olan bireyler için çok adımlı problem çözme içeren görevler dikkat yönetimini etkin biçimde kullanma fırsatı sunar.',
                        'Zaman baskısı altında odaklanmayı sürdürebileceği çalışmalarla dikkatin sürekliliği güçlendirilebilir.',
                        'Eş zamanlı dikkat gerektiren veya görevler arası geçiş içeren etkinliklerle bölünmüş dikkat becerisi pekiştirilebilir.',
                        'Strateji geliştirme gerektiren oyunlar ve uygulamalarla dikkat kontrolü esnek biçimde kullanılabilir.',
                        'Ayrıca bilgi işleme süreçlerini de içeren görevlerde hız ve doğruluk arasındaki dengeyi koruma becerisi geliştirilebilir.'
                    ]},
                    { min: 50, max: 74, recommendations: [
                        'Dikkat süresini korumakta zaman zaman güçlük yaşayan bireyler için, uyaranların azaltıldığı ortamlarda yapılan yapılandırılmış görevler odaklanmayı kolaylaştırabilir.',
                        'Adım adım ilerleyen yönergelerle çalışmak, görev takibini ve odaklanmayı destekler.',
                        'Bilişsel yükü düşük ama dikkat gerektiren etkinliklerle dikkatin sürdürülebilirliği artırılabilir.',
                        'Etkin dinleme, metin inceleme ya da görsel detaylara odaklanma gibi çalışmalarda ayrıntı fark etme becerisi geliştirilebilir.',
                        'Ayrıca, dikkat dağıtıcı unsurları ayırt etmeye yönelik seçici dikkat uygulamaları da sürece katkı sunar.'
                    ]},
                    { min: 25, max: 49, recommendations: [
                        'Dikkatin belirli bir noktada toplanmasını sağlamak amacıyla kısa süreli, görsel ve işitsel destekli etkinliklerle odaklanma başlatılabilir.',
                        'Görev sırasında dikkat dağıtıcıların azaltılması ve mola sürelerinin önceden belirlenmesi odaklanmayı kolaylaştırır.',
                        'Hedefi net, kısa ve yapılandırılmış görevler dikkat başlatma ve sürdürme süreçlerini destekler.',
                        'Sesli yönergeler, işaretlemeler ve eşleştirme gibi somut desteklerle dikkat yönetimi daha işlevsel hale getirilebilir.',
                        'Ayrıca, zorluk düzeyi kademeli olarak artan dikkat çalışmaları, zihinsel takibin sürdürülebilmesine katkı sağlayabilir.'
                    ]},
                    { min: 0, max: 24, recommendations: [
                        'Dikkat düzeyi düşük bireylerde, kısa süreli ve net yönergeler içeren görevlerle dikkat süresi kademeli olarak artırılabilir.',
                        'Dikkat dağıtıcıların azaltıldığı ortamlarda yapılan etkinlikler odaklanmayı kolaylaştırır.',
                        'Görsel ve işitsel ipuçlarıyla desteklenen çalışmalar dikkat yönlendirmesini sağlayabilir.',
                        'Bilişsel beceri geliştiren egzersizlerle seçici dikkat pekiştirilebilir.',
                        'Ayrıca adım adım ilerleyen ve yönerge takibini destekleyen yapılandırılmış görevlerle dikkat ve odaklanma becerisi geliştirilebilir.'
                    ]}
                ]
            },
            hafiza_skoru: {
                ranges: [
                    { min: 75, max: 100, recommendations: [
                        'Hafıza becerisi güçlü bireylerde, kavramsal bütünlük gerektiren metinler ve üst düzey analiz gerektiren içeriklerle çalışma, hafızayı daha ileri düzeyde kullanma fırsatı sunar.',
                        'Yazılı, işitsel ve görsel ögelerin bir arada kullanıldığı çoklu kodlama teknikleri, bilgilerin kalıcılığını artırabilir.',
                        'Bilgiler arası anlam ilişkileri kurularak yapılan öğrenmeyi güçlendirir.',
                        'Aralıklı tekrarlarla yapılan egzersizler uzun süreli hafızanın gücünü pekiştirir.',
                        'Ayrıca, öğrendiği bilgileri sadece ezberlemekle kalmayıp farklı durumlarda da kullanabilmesi için problem çözme, uygulama ve günlük yaşamla ilişkilendirme gibi egzersizlerle bilgilerin pekiştirilmesi sağlanabilir.'
                    ]},
                    { min: 50, max: 74, recommendations: [
                        'Öğrenilen bilgilerin hafızada daha uzun süre kalmasını desteklemek için düzenli aralıklarla tekrar yapılması önemlidir.',
                        'Görselleştirme, hikayeleştirme gibi zihinsel imgelerle anlatılan bilgiler daha kolay hatırlanabilir.',
                        'Benzerlik kurma ve kavramsal bağlantılar oluşturma gibi ilişkisel öğrenme yöntemleri, yeni bilgilerin öncekilerle bütünleşmesini sağlar.',
                        'Öğrenilen bilgileri kendi cümleleriyle özetlemesi ve başkasına anlatması hatırlamayı kolaylaştırır.',
                        'Ayrıca dikkatli ve yönlendirilmiş biçimde yapılan kodlama çalışmaları (örneğin altı çizili, vurgulu, örnekli içeriklerle sunum) bilgilerin hafızada zihinsel temsillerle yer etmesini destekler.'
                    ]},
                    { min: 25, max: 49, recommendations: [
                        'Görsel destekli tekrarlar (şema, tablo, resim vb.) ve kısa aralıklarla yapılan tekrarlar bilgilerin unutulmadan pekişmesini sağlar.',
                        'Bilgilerin madde madde sınıflandırılması, kavram haritası çıkarılması ve sesli ya da yazılı şekilde tekrar edilmesi, geri çağırmayı kolaylaştırabilir.',
                        'Yeni bilgiler küçük parçalara bölünerek öğrenildiğinde hem zihinsel yük azalır hem de hafızanın kapasitesi zorlanmadan desteklenmiş olur.'
                    ]},
                    { min: 0, max: 24, recommendations: [
                        'Bilgilerin tanıdık nesne, kişi ve olaylarla ilişkilendirilmesi, hatırlamayı kolaylaştırabilir.',
                        'Tek seferde fazla bilgi sunmak yerine, bilgi kısa, sade ve adım adım verilmelidir.',
                        'Görsel ve işitsel desteklerle yapılan tekrarlar; doğru pekiştirme bildirimleriyle birlikte uygulandığında öğrenmeyi destekleyebilir.',
                        'Bu bireylerde hafıza süreci, zamanında yapılandırılmış tekrar rutinleriyle ve somutlaştırılmış örneklerle daha etkili hale getirilebilir.'
                    ]}
                ]
            },
            isleme_hizi_skoru: {
                ranges: [
                    { min: 75, max: 100, recommendations: [
                        'Zaman baskısı altında dikkat gerektiren görevler (örneğin süreli testler, refleks temelli uygulamalar) ile hızlı karar verme ve tepki süresi desteklenebilir.',
                        'Grafik okuma, tablo yorumlama ve bilgi tarama gibi akademik içerikler hızla işlemleme becerisini pekiştirir.',
                        'Problem çözme içeren çok adımlı görevlerde süre sınırı eklenerek hızla birlikte bilişsel esneklik geliştirilebilir.',
                        'Bilgiyi organize etme ve sunma gibi üretken görevlerde de işlemleme hızından faydalanılabilir.'
                    ]},
                    { min: 50, max: 74, recommendations: [
                        'Kısa süreli ve tekrar edilebilir görevlerle bilgiye hızlıca erişme ve tepki verme becerisi geliştirilebilir.',
                        'İşitsel ve görsel ipuçlarıyla desteklenen uygulamalar, dikkati sürdürmeye yardımcı olurken işlem süresini hızlandırır.',
                        'Grafik ve tablo okuma gibi yapılandırılmış görevler, süre baskısı içermeyen şekilde sunularak hızın kademeli gelişimi desteklenebilir.',
                        'Ayrıca, küçük problem çözme adımlarıyla yapılandırılmış akademik görevlerde hız ve doğruluk dengesi kurularak işlemleme becerisi güçlendirilebilir.'
                    ]},
                    { min: 25, max: 49, recommendations: [
                        'Bilgiye erişim süreci, süre baskısı olmadan yapılan tekrarlarla desteklenebilir.',
                        'Küçük adımlarla ilerlenen alıştırmalar, işlem sürecinin güvenle sürdürülmesini sağlar.',
                        'Görsel destekli yönergeler ve adım adım rehberlik içeren uygulamalar, bilgiyi tanıma ve tepki verme süresini kademeli olarak hızlandırabilir.',
                        'Sıralama, sınıflama ve eşleştirme gibi düşük bilişsel yük içeren görevler, işlemleme hızının temel basamaklarını destekler.',
                        'Ayrıca zihinsel işlem basamaklarını fark ettiren etkinliklerle öğrencinin süreci tanıma becerisi pekiştirilebilir.'
                    ]},
                    { min: 0, max: 24, recommendations: [
                        'Bilgiyi algılama ve yanıt verme süreci genellikle yavaştır. Bu nedenle yazılı yönergelere ek olarak, görsellerle desteklenmiş açık ve sade yönergeler kullanılmalıdır.',
                        'Zaman baskısı içermeyen, yapılandırılmış ve tekrarlanabilir görevlerle bilgiye erişim kolaylaştırılabilir.',
                        'Tanıdık içeriklere dayalı sınıflama, eşleştirme ve adım adım sıralama gibi görevler, süreci anlaşılır kılarak işlem hızının temellerini atar.',
                        'Ayrıca, çok adımlı görevler küçük parçalara bölünerek uygulandığında hem güven duygusu hem hız gelişimi desteklenebilir.'
                    ]}
                ]
            },
            gorsel_isleme_skoru: {
                ranges: [
                    { min: 75, max: 100, recommendations: [
                        'Görselleştirme becerisi güçlü olan bireylerde, çok adımlı görsel bilgiyi analiz etmeyi gerektiren görevler (örneğin harita okuma, şekil-yerleştirme, şematik düzenleme) üst düzey görsel akıl yürütmeyi destekleyebilir.',
                        'Farklı açılardan bakmayı ve detaylara dikkat etmeyi gerektiren uygulamalar (örneğin şekil tamamlama, desen oluşturma, diyagram analizi) bu beceriyi daha ileri seviyeye taşıyabilir.',
                        'Grafik, şekil ve tablo gibi görsel verilerin yorumlandığı görevlerde hem bütünsel hem parçaya odaklı analiz yapma becerisi güçlenir.',
                        'Soyut görsel bilgiyi organize etmeyi gerektiren çalışmalar (örneğin kavram haritası, zihin haritası) bireyin anlam kurma süreçlerini derinleştirebilir.'
                    ]},
                    { min: 50, max: 74, recommendations: [
                        'Görsel verileri dikkatle incelemeyi gerektiren çalışmalar (örneğin tablo, grafik, şekil gibi) ile ayrıntılara odaklanma becerisi desteklenebilir.',
                        'Görsel yönergeler içeren görevlerde, her bir adımın açık şekilde açıklanması ve uygulama sırasında yönlendirilmesi, süreci daha anlaşılır hâle getirir.',
                        'Harita, diyagram ve şekil yorumlama etkinlikleri önce genel yapıdan başlanarak adım adım analizle sürdürüldüğünde görsel bilgiyi anlamlandırma süreci pekiştirilebilir.',
                        'Ayrıca, görsel materyallerle sunulan bilgilerin sözel açıklamalarla desteklenmesi hem işitsel hem görsel temsil sistemlerinin birlikte çalışmasını sağlayarak anlamı güçlendirebilir.'
                    ]},
                    { min: 25, max: 49, recommendations: [
                        'Görsel ayrıntılara odaklanmayı desteklemek için, benzer görseller arasında belirli özelliklere göre ayrım yapmayı gerektiren çalışmalara yer verilebilir.',
                        'Bu süreçlerde, dikkat edilmesi gereken ipuçlarının açıkça belirtilmesi ve işlem sıralamasının net şekilde sunulması, anlamlı bir odaklanma süreci sağlar.',
                        'Görsel içeriklerin sade, az detaylı ve dikkat dağıtıcı unsurlardan arındırılmış biçimde yapılandırılması; temel yön, konum ve biçim ilişkilerinin kavranmasına yönelik etkinliklerle desteklendiğinde, görsel anlam kurma süreçleri güçlendirilebilir.'
                    ]},
                    { min: 0, max: 24, recommendations: [
                        'Görsel bilgileri ayırt etme ve takip etme becerisi sınırlı olan bireylerde, benzer ve farklı özelliklerin anlaşılmasını kolaylaştıran görsel çalışmalarla temel görsel ayrım becerisi desteklenebilir.',
                        'Görsel ögelerin (şekil, simge, yön, dizi vb.) düzenli bir yapı içinde sunulması, tanıma ve sıralama süreçlerini yapılandırır.',
                        'Görsel dikkat ve düzen algısını geliştirmek için, basitten karmaşığa ilerleyen çalışmalarda şekiller arası ilişki kurma ve görsel yönergelere dayalı uygulama adımlarını takip etme becerileri önceliklendirilebilir.',
                        'Ayrıca görsel materyallerin sadeleştirilmiş, belirgin ve yönlendirici biçimde sunulması, anlam kurmayı ve görsel organizasyonu kolaylaştırır.'
                    ]}
                ]
            },
            akil_mantik_yurutme_skoru: {
                ranges: [
                    { min: 75, max: 100, recommendations: [
                        'Akıl yürütme becerisi güçlü bireylerde, çok adımlı problem çözme süreçlerini içeren görevler farklı çözüm yolları üretme becerisini geliştirebilir.',
                        'Neden-sonuç ilişkileri kurmayı gerektiren açıklama ve değerlendirme etkinlikleri (örneğin "sence neden böyle oldu?" gibi) düşünsel derinliği artırabilir.',
                        'Grafik, tablo ve veri yorumlama gibi karşılaştırma ve analiz temelli uygulamalarla mantıksal düzenleme yetisi desteklenebilir.',
                        'Soyut akıl yürütme gerektiren kelime-sayı dizileri ya da stratejiye dayalı mantık oyunları, bilişsel esnekliği artırarak bireyin çok yönlü düşünme becerisini pekiştirebilir.'
                    ]},
                    { min: 50, max: 74, recommendations: [
                        'Günlük yaşamdan örnekler kullanılarak olaylar arasındaki neden–sonuç ilişkilerini kurma becerisi desteklenebilir.',
                        'Farklı durumlar karşısında mantıklı çıkarımlar yapabilmesini sağlamak için, "hangi bilgi eksik?", "bu olaydan sonra ne olurdu?" gibi sorularla düşünme süreci yönlendirilebilir.',
                        'Problem çözme egzersizleri ile sıraya koyma ve çözüm yollarını organize etme becerisi geliştirilebilir.',
                        'Gruplama, karşılaştırma ve benzerlik–farklılık gibi analiz çalışmaları bilişsel esnekliği artırarak akıl yürütme süreçlerine katkı sağlayabilir.'
                    ]},
                    { min: 25, max: 49, recommendations: [
                        'Akıl ve mantık yürütme becerisini desteklemek amacıyla günlük yaşamdan alınan basit ve somut örneklerle karar verme süreçleri yapılandırılabilir.',
                        '"Eğer… ise…" gibi temel neden-sonuç kalıplarıyla düşünme adımları pekiştirilebilir.',
                        'Doğru-yanlış karşılaştırmaları içeren egzersizler ile seçenekleri değerlendirme becerisi geliştirilebilir.'
                    ]},
                    { min: 0, max: 24, recommendations: [
                        'Akıl ve mantık yürütme adımlarını belirginleştiren çalışmalar faydalı olabilir.',
                        'Somut örnekler ve görsellerle desteklenen uygulamalar hangi bilginin hangi kararla ilişkili olduğunu fark etmeyi kolaylaştırır.',
                        'Verilen seçenekleri karşılaştırarak değerlendirmeyi içeren egzersizler ayırt etme ve karar verme becerisini destekleyebilir.'
                    ]}
                ]
            },
            bilissel_esneklik_skoru: {
                ranges: [
                    { min: 75, max: 100, recommendations: [
                        'Farklı kural ve strateji gerektiren görevler arka arkaya verilerek bireyin görev geçişlerinde esneklik ve uyum becerisi desteklenebilir.',
                        'Problem çözme egzersizleri ile farklı düşünme yolları geliştirilmesi sağlanabilir.',
                        'Rol değişimi içeren grup çalışmaları ve değişen kurallarla oynanan strateji oyunları bilişsel esnekliği artırabilir.',
                        'Planlama, uygulama ve değerlendirme adımlarını içeren karmaşık görevlerde bireye aktif sorumluluk verilerek farklı işlevler arasında geçiş yapma pratiği kazandırılabilir.'
                    ]},
                    { min: 50, max: 74, recommendations: [
                        'Benzer görevlerde kural değişiklikleri yapılarak bireyin yeni kurallara uyum sağlaması desteklenebilir.',
                        'Görev geçişlerinde, önceki ve yeni kural arasındaki farkları açıklaması istenerek karşılaştırmalı düşünme becerisi geliştirilebilir.',
                        'Kademeli olarak artan karmaşıklığa sahip problem çözme çalışmalarıyla alternatif düşünme yolları oluşturması teşvik edilebilir.',
                        'Yönergeler arasında geçiş yapmayı gerektiren görevlerde adım adım rehberlik sunulması; karşılaştığı engelleri farklı yollarla aşması için yönlendirici sorularla düşünme sürecinin desteklenmesi bilişsel esnekliği artırabilir.'
                    ]},
                    { min: 25, max: 49, recommendations: [
                        'Kural değişiklikleri açık ve sade biçimde sunularak bireyin yeni duruma uyum sağlaması kolaylaştırılabilir.',
                        'Beklenmedik görev değişimlerinde, geçiş süreci yapılandırılmış adımlarla desteklenebilir.',
                        'Karar verme sırasında "şimdi ne yapmalıyım?" gibi sorularla düşünme süreci yönlendirilebilir.',
                        'Aynı içeriğe sahip görevlerde küçük değişiklikler yapılarak esnek düşünme becerisi kademeli olarak geliştirilebilir.',
                        'Ayrıca, alternatif çözüm yollarını fark etmesi için rehber sorularla destek sunulması bilişsel esnekliğin güçlenmesine katkı sağlayabilir.'
                    ]},
                    { min: 0, max: 24, recommendations: [
                        'Görevler öncelikle sabit, sade ve tahmin edilebilir bir yapıda sunulmalı; ardından küçük kural değişiklikleriyle geçişler adım adım yapılandırılmalıdır.',
                        'Kural farklılıkları açık şekilde ifade edilerek görsellerle desteklenebilir.',
                        '"Bu kuralla nasıl oynanır?" gibi sorularla bireyin dikkatini yeni kurala yöneltmek mümkündür.',
                        'Her adımı modelleme ile gösterilen uygulamalarda bireyin farklı stratejileri denemesi teşvik edilebilir.',
                        'Aynı görevin farklı kurallarla tekrar ettirilmesi, bireyin yeni durumlara uyum sağlamasını kolaylaştırabilir.'
                    ]}
                ]
            }
        };

        // Function to get score range info
        function getScoreRangeInfo(skillName, score) {
            const ranges = scoreRanges[skillName]?.ranges || [];
            return ranges.find(range => score >= range.min && score <= range.max) || 
                { level: 'Bilinmeyen', description: 'Skor aralığı tanımlanmamış.' };
        }

        // Function to get recommendations
        function getRecommendations(skillName, score) {
            const ranges = detailedRecommendations[skillName]?.ranges || [];
            const range = ranges.find(range => score >= range.min && score <= range.max);
            return range?.recommendations || ['Bu skor aralığı için özel öneriler henüz tanımlanmamış.'];
        }

        // Function to populate personal info
        function populatePersonalInfo() {
            const student = cognitiveData.student;
            document.querySelectorAll('.info-item').forEach(item => {
                const label = item.querySelector('.info-label').textContent;
                const valueSpan = item.querySelector('span:last-child');
                
                switch(label) {
                    case 'Ad Soyad':
                        valueSpan.textContent = student.name;
                        break;
                    case 'Cinsiyet':
                        valueSpan.textContent = student.gender;
                        break;
                    case 'Yaş':
                        valueSpan.textContent = student.age;
                        break;
                    case 'Doğum Tarihi':
                        valueSpan.textContent = student.birthDate;
                        break;
                    case 'Değerlendirme Tarihi':
                        valueSpan.textContent = student.evaluationDate;
                        break;
                    case 'Uygulayan':
                        valueSpan.textContent = student.evaluator;
                        break;
                }
            });
        }

        // Function to populate scores table
        function populateScoresTable() {
            const scores = cognitiveData.scores;
            const tableRows = document.querySelectorAll('.skills-table tbody tr');
            
            tableRows.forEach((row, index) => {
                const scoreCell = row.querySelector('.score-high, .score-medium, .score-low');
                if (scoreCell) {
                    let score;
                    switch(index) {
                        case 0: score = scores.dikkat_skoru; break;
                        case 1: score = scores.hafiza_skoru; break;
                        case 2: score = scores.isleme_hizi_skoru; break;
                        case 3: score = scores.gorsel_isleme_skoru; break;
                        case 4: score = scores.akil_mantik_yurutme_skoru; break;
                        case 5: score = scores.bilissel_esneklik_skoru; break;
                    }
                    
                    if (score !== undefined) {
                        scoreCell.textContent = `%${score}`;
                        
                        // Update score class based on value
                        scoreCell.className = score >= 75 ? 'score-high' : 
                                            score >= 50 ? 'score-medium' : 'score-low';
                    }
                }
            });
        }

        // Function to populate skill analysis (Page 3)
        function populateSkillAnalysis() {
            const scores = cognitiveData.scores;
            const skillAnalyses = document.querySelectorAll('.skill-analysis');
            
            // Always show skills in this fixed order
            const skillOrder = [
                'dikkat_skoru',
                'hafiza_skoru', 
                'isleme_hizi_skoru',
                'gorsel_isleme_skoru',
                'akil_mantik_yurutme_skoru',
                'bilissel_esneklik_skoru'
            ];
            
            // Update each skill analysis section
            skillOrder.forEach((skillKey, index) => {
                if (index < skillAnalyses.length && scores[skillKey] !== undefined) {
                    const skillScore = scores[skillKey];
                    const skillInfo = getScoreRangeInfo(skillKey, skillScore);
                    
                    skillAnalyses[index].querySelector('.skill-name').textContent = 
                        `${getSkillDisplayName(skillKey)} Skoru: % ${skillScore}`;
                    skillAnalyses[index].querySelector('.skill-description').textContent = skillInfo.description;
                }
            });
        }

        // Function to get display name for skills
        function getSkillDisplayName(skillKey) {
            const displayNames = {
                'dikkat_skoru': 'Dikkat',
                'hafiza_skoru': 'Hafıza',
                'isleme_hizi_skoru': 'İşleme Hızı',
                'gorsel_isleme_skoru': 'Görsel İşleme',
                'akil_mantik_yurutme_skoru': 'Akıl ve Mantık Yürütme',
                'bilissel_esneklik_skoru': 'Bilişsel Esneklik'
            };
            return displayNames[skillKey] || skillKey;
        }

        // Function to populate recommendations (Pages 4-5)
        function populateRecommendations() {
            const scores = cognitiveData.scores;
            const recommendationBoxes = document.querySelectorAll('.recommendation-box');
            
            // Fixed order of skills matching HTML boxes order
            const skillOrder = [
                'dikkat_skoru',
                'hafiza_skoru', 
                'isleme_hizi_skoru',
                'gorsel_isleme_skoru',
                'akil_mantik_yurutme_skoru',
                'bilissel_esneklik_skoru'
            ];
            
            recommendationBoxes.forEach((box, index) => {
                if (index < skillOrder.length) {
                    const skillKey = skillOrder[index];
                    const score = scores[skillKey] || 0;
                    const recommendations = getRecommendations(skillKey, score);
                    
                    const titleElement = box.querySelector('.recommendation-title');
                    const contentElement = box.querySelector('.recommendation-content');
                    
                    if (titleElement && contentElement) {
                        titleElement.textContent = getSkillDisplayName(skillKey);
                        contentElement.innerHTML = recommendations.map(rec => `<p>• ${rec}</p>`).join('');
                    }
                }
            });
        }

        // Update 2nd page vertical bars from DB scores (Option A)
        function updateVerticalBarsFromScores() {
            const { dikkat_skoru, hafiza_skoru, isleme_hizi_skoru, gorsel_isleme_skoru, akil_mantik_yurutme_skoru, bilissel_esneklik_skoru } = cognitiveData.scores;
            const scoresArr = [
                dikkat_skoru ?? 0,
                hafiza_skoru ?? 0,
                isleme_hizi_skoru ?? 0,
                gorsel_isleme_skoru ?? 0,
                akil_mantik_yurutme_skoru ?? 0,
                bilissel_esneklik_skoru ?? 0
            ];

            // Target only the vertical bar chart on Page 2
            const barItems = document.querySelectorAll('.page:nth-of-type(2) .vertical-bar-chart .bar-item');

            // Decide max height based on current CSS height of container, fallback to 200
            const container = document.querySelector('.page:nth-of-type(2) .vertical-bar-chart');
            let maxHeight = 200;
            if (container) {
                const computed = window.getComputedStyle(container);
                const h = parseInt(computed.height, 10);
                if (!isNaN(h) && h > 0) {
                    // Leave some headroom for value labels
                    maxHeight = Math.max(120, h - 60);
                }
            }

            barItems.forEach((item, idx) => {
                const bar = item.querySelector('.bar');
                const val = item.querySelector('.bar-value');
                const score = Math.max(0, Math.min(100, Number(scoresArr[idx] || 0)));
                const heightPx = Math.round((score / 100) * maxHeight);

                if (val) {
                    val.textContent = `%${score}`;
                }

                if (bar) {
                    // Set color class by ranges
                    bar.classList.remove('bar-high', 'bar-medium', 'bar-low');
                    if (score >= 75) bar.classList.add('bar-high');
                    else if (score >= 50) bar.classList.add('bar-medium');
                    else bar.classList.add('bar-low');

                    // Reset height to animate from 0
                    bar.style.height = '0px';
                    bar.setAttribute('data-height', String(heightPx));
                }
            });
        }

        // Function to load data from Supabase database
        async function loadCognitiveData(sessionId) {
            if (!sessionId) {
                logger.error('❌ Session ID is required');
                alert('Session ID gerekli!');
                return false;
            }

            logger.log('🔍 Loading cognitive data for session ID:', sessionId);
            
            try {
                // Initialize Supabase client
                const supabaseUrl = 'https://gamjzzomkosvqhficabt.supabase.co';
                const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdhbWp6em9ta29zdnFoZmljYWJ0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI4ODc3MDAsImV4cCI6MjA2ODQ2MzcwMH0.r8KkywdhNSP1hxzSAlKo8SB5jOEb0KQRUBfZ9Va0p9I';
                
                // Create Supabase client (using CDN version)
                const { createClient } = window.supabase;
                const supabase = createClient(supabaseUrl, supabaseKey);
                
                logger.log('🔗 Supabase client initialized');
                
                // Optimized single query - try both id and session_id at once
                logger.log('🔍 Fetching cognitive data...');
                
                const { data: cognitiveResults, error: cognitiveError } = await supabase
                    .from('cognitive_test_result')
                    .select(`
                        *,
                        student:student_id(id, first_name, last_name, demographic_info),
                        conductor:conducted_by(id, first_name, last_name)
                    `)
                    .or(`id.eq.${sessionId},session_id.eq.${sessionId}`)
                    .limit(1);
                
                const cognitiveResult = cognitiveResults?.[0] || null;
                
                if (cognitiveResult) {
                    logger.log('✅ Found cognitive data for:', sessionId);
                } else {
                    logger.warn('⚠️ No cognitive data found for:', sessionId);
                }
                
                if (cognitiveError) {
                    logger.error('❌ Error fetching cognitive data:', cognitiveError);
                    logger.warn('Falling back to sample data');
                    return false;
                }
                
                if (!cognitiveResult) {
                    logger.error('❌ No cognitive data found for session:', sessionId);
                    alert('Bu session ID için rapor bulunamadı. Lütfen geçerli bir session ID kullanın.');
                    return false;
                }
                
                logger.log('✅ Raw cognitive data loaded:', cognitiveResult);
                
                // STEP 1: Update cognitive scores with database values
                logger.log('📊 Updating cognitive scores...');
                cognitiveData.scores = {
                    dikkat_skoru: cognitiveResult.dikkat_skoru || 0,
                    hafiza_skoru: cognitiveResult.hafiza_skoru || 0,
                    isleme_hizi_skoru: cognitiveResult.isleme_hizi_skoru || 0,
                    gorsel_isleme_skoru: cognitiveResult.gorsel_isleme_skoru || 0,
                    akil_mantik_yurutme_skoru: cognitiveResult.akil_mantik_yurutme_skoru || 0,
                    bilissel_esneklik_skoru: cognitiveResult.bilissel_esneklik_skoru || 0
                };
                logger.log('✅ Scores updated:', cognitiveData.scores);
                
                // STEP 2: Update student and conductor info from database (directly from users)
                logger.log('👤 Updating student and conductor info...');
                const studentInfo = cognitiveResult.student;
                const conductorInfo = cognitiveResult.conductor;

                // Deep log objects to inspect shapes
                try {
                    logger.log('🧩 cognitiveResult keys:', Object.keys(cognitiveResult || {}));
                } catch(_) {}
                logger.log('🧩 raw studentInfo:', studentInfo);
                logger.log('🧩 raw conductorInfo:', conductorInfo);
                
                if (studentInfo) {
                    logger.log('📝 Processing student info:', studentInfo);
                    
                    // Parse demographic info if it exists
                    let demographicInfo = {};
                    if (studentInfo.demographic_info) {
                        try {
                            demographicInfo = typeof studentInfo.demographic_info === 'string' 
                                ? JSON.parse(studentInfo.demographic_info) 
                                : studentInfo.demographic_info;
                            logger.log('✅ Demographic info parsed:', demographicInfo);
                        } catch (e) {
                            logger.warn('⚠️ Failed to parse demographic_info:', e);
                        }
                    } else {
                        logger.log('ℹ️ No demographic_info on studentInfo');
                    }
                    
                    // Calculate age from birth_date
                    const birthDate = demographicInfo.birth_date ? new Date(demographicInfo.birth_date) : new Date('1990-01-01');
                    const today = new Date();
                    const ageInMs = today - birthDate;
                    const ageInYears = Math.floor(ageInMs / (365.25 * 24 * 60 * 60 * 1000));
                    const ageInMonths = Math.floor((ageInMs % (365.25 * 24 * 60 * 60 * 1000)) / (30.44 * 24 * 60 * 60 * 1000));
                    const ageInDays = Math.floor((ageInMs % (30.44 * 24 * 60 * 60 * 1000)) / (24 * 60 * 60 * 1000));
                    
                    // Uygulayan bilgisini users tablosundan user.supervisor_id ile al
                    let evaluatorName = '';
                    
                    try {
                        // Önce öğrenci user bilgisini al, sonra onun supervisor_id'sini kullan
                        if (studentInfo && studentInfo.id) {
                            logger.log('🔎 Fetching user info for student_id:', studentInfo.id);
                            
                            const { data: userData, error: userErr } = await supabase
                                .from('users')
                                .select('id, supervisor_id')
                                .eq('id', studentInfo.id)
                                .single();
                                
                            if (userErr) {
                                logger.warn('⚠️ User lookup error:', userErr);
                            } else if (userData && userData.supervisor_id) {
                                logger.log('🔎 Fetching evaluator from user.supervisor_id:', userData.supervisor_id);
                                
                                const { data: supervisorData, error: supervisorErr } = await supabase
                                    .from('users')
                                    .select('id, first_name, last_name')
                                    .eq('id', userData.supervisor_id)
                                    .single();
                                    
                                if (supervisorErr) {
                                    logger.warn('⚠️ Supervisor lookup error:', supervisorErr);
                                } else if (supervisorData) {
                                    evaluatorName = `${supervisorData.first_name || ''} ${supervisorData.last_name || ''}`.trim();
                                    logger.log('✅ Evaluator found via user.supervisor_id:', evaluatorName);
                                }
                            } else {
                                logger.warn('⚠️ No supervisor_id found in user data');
                            }
                        } else {
                            logger.warn('⚠️ No student ID found');
                        }
                    } catch (e) {
                        logger.warn('⚠️ Failed to fetch evaluator from user.supervisor_id:', e);
                    }

                    cognitiveData.student = {
                        name: `${studentInfo.first_name || ''} ${studentInfo.last_name || ''}`.trim() || 'Bilinmeyen',
                        gender: demographicInfo.gender || 'Belirtilmemiş',
                        age: `${ageInYears} Yıl ${ageInMonths} Ay ${ageInDays} Gün`,
                        birthDate: birthDate.toLocaleDateString('tr-TR'),
                        evaluationDate: new Date(cognitiveResult.test_start_time || cognitiveResult.created_at).toLocaleDateString('tr-TR'),
                        evaluator: evaluatorName || 'Sistem'
                    };
                    logger.log('✅ Student info updated:', cognitiveData.student);
                } else {
                    logger.warn('⚠️ No student info found in database result');
                }
                
                // STEP 3: Parse alt_test_ozetleri for dynamic recommendations and score ranges
                logger.log('📋 Processing alt_test_ozetleri...');
                if (cognitiveResult.alt_test_ozetleri) {
                    try {
                        const altTestOzetleri = typeof cognitiveResult.alt_test_ozetleri === 'string' 
                            ? JSON.parse(cognitiveResult.alt_test_ozetleri) 
                            : cognitiveResult.alt_test_ozetleri;
                        
                        logger.log('📊 Parsed alt_test_ozetleri:', altTestOzetleri);
                        
                        // Update scoreRanges and detailedRecommendations if available
                        if (altTestOzetleri.scoreRanges) {
                            scoreRanges = altTestOzetleri.scoreRanges;
                            logger.log('✅ Updated scoreRanges from database');
                        }
                        
                        if (altTestOzetleri.detailedRecommendations) {
                            detailedRecommendations = altTestOzetleri.detailedRecommendations;
                            logger.log('✅ Updated detailedRecommendations from database');
                        }
                        
                        // If alt_test_ozetleri contains individual test summaries, use them
                        if (altTestOzetleri.dikkat || altTestOzetleri.hafiza || altTestOzetleri.stroop || altTestOzetleri.puzzle || altTestOzetleri.akil_mantik) {
                            logger.log('📋 Individual test summaries found in alt_test_ozetleri');
                            // These could be used for more detailed analysis if needed
                        }
                        
                    } catch (parseError) {
                        logger.warn('⚠️ Could not parse alt_test_ozetleri:', parseError);
                    }
                } else {
                    logger.log('ℹ️ No alt_test_ozetleri found, using default recommendations');
                }
                
                // STEP 4: Refresh all displays with new data
                logger.log('🔄 Refreshing all displays with database data...');
                populateAllData();
                
                logger.log('🎉 Cognitive data successfully loaded and all displays updated!');
                
                // Hide loading overlay and show content
                const loadingOverlay = document.getElementById('loadingOverlay');
                if (loadingOverlay) {
                    loadingOverlay.style.display = 'none';
                }
                document.body.classList.add('loaded');
                
                return true;
                
            } catch (error) {
                logger.error('❌ Critical error loading cognitive data:', error);
                alert('Rapor yüklenirken kritik bir hata oluştu: ' + error.message);
                return false;
            }
        }

        // Function to populate all dynamic data
        // Optimized chart cleanup with throttling
        const destroyAllCharts = (() => {
            let isDestroying = false;
            return function() {
                if (isDestroying) return;
                isDestroying = true;
                
                setTimeout(() => {
                    try {
                        // Efficiently destroy charts by ID
                        ['barChart', 'radarChart', 'verticalBarChart'].forEach(id => {
                            const chart = Chart.getChart(id);
                            if (chart && typeof chart.destroy === 'function') {
                                chart.destroy();
                            }
                        });
                        
                        // Clean up instance references
                        [barChartInstance, radarChartInstance].forEach(instance => {
                            if (instance && typeof instance.destroy === 'function') {
                                try { instance.destroy(); } catch(_) { /* ignore */ }
                            }
                        });
                        
                        barChartInstance = null;
                        radarChartInstance = null;
                    } catch (e) {
                        logger.warn('Chart cleanup error:', e);
                    } finally {
                        isDestroying = false;
                    }
                }, 10); // Small delay to prevent rapid destruction
            };
        })();

        // Optimized population function with batched updates
        function populateAllData() {
            // Batch DOM updates for better performance
            requestAnimationFrame(() => {
                try {
                    // Step 1: Update data elements
                    populatePersonalInfo();
                    populateScoresTable();
                    populateSkillAnalysis();
                    
                    // Step 2: Handle recommendations in next frame
                    requestAnimationFrame(() => {
                        populateRecommendations();
                        
                        // Step 3: Update charts in final frame
                        requestAnimationFrame(() => {
                            try {
                                // Update page-2 vertical bars from DB scores and animate
                                updateVerticalBarsFromScores();
                                animateVerticalBars();
                                
                                // Destroy all charts before recreating to avoid "canvas already in use"
                                destroyAllCharts();
                                
                                // Update charts with real database data
                                logger.log('📈 Updating charts with database data...');
                                createRadarChart(); // Update radar chart with real data
                                logger.log('✅ Charts updated with database data');
                            } catch (chartError) {
                                logger.error('Chart creation error:', chartError);
                            }
                        });
                    });
                } catch (error) {
                    logger.error('Data population error:', error);
                }
            });
        }

        // Chart creation functions
        function createVerticalBarChart() {
            const ctx = document.getElementById('verticalBarChart');
            if (ctx) {
                // Safely destroy existing chart if it exists
                try {
                    if (barChartInstance && typeof barChartInstance.destroy === 'function') {
                        barChartInstance.destroy();
                    }
                } catch (e) {
                    console.warn('Warning destroying bar chart instance:', e);
                }
                
                // Also guard against any globally registered chart on this canvas id
                try {
                    const existing = Chart.getChart('verticalBarChart');
                    if (existing && typeof existing.destroy === 'function') {
                        existing.destroy();
                    }
                } catch (e) {
                    console.warn('Warning destroying existing vertical bar chart:', e);
                }

                const scores = cognitiveData.scores;
                barChartInstance = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['Dikkat', 'Hafıza', 'İşleme Hızı', 'Görsel İşleme', 'Akıl Yürütme', 'Bilişsel Esneklik'],
                        datasets: [{
                            data: [
                                scores.dikkat_skoru,
                                scores.hafiza_skoru,
                                scores.isleme_hizi_skoru,
                                scores.gorsel_isleme_skoru,
                                scores.akil_mantik_yurutme_skoru,
                                scores.bilissel_esneklik_skoru
                            ],
                            backgroundColor: ['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7', '#DDA0DD'],
                            borderWidth: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            x: {
                                grid: {
                                    display: false
                                }
                            },
                            y: {
                                beginAtZero: true,
                                max: 100,
                                ticks: {
                                    stepSize: 20
                                },
                                grid: {
                                    color: '#E0E0E0'
                                }
                            }
                        }
                    }
                });
            }
        }

        // REFERENCE-BASED WORKING RADAR CHART WITH TOOLTIPS
        function createRadarChart() {
            const ctx = document.getElementById('radarChart');
            if (!ctx) return;

            // Simple destroy
            try { Chart.getChart(ctx)?.destroy(); } catch(e) {}

            // Get real data or use defaults from reference
            const scores = cognitiveData?.scores || {};
            const data = [
                scores.dikkat_skoru || 81,
                scores.hafiza_skoru || 68,
                scores.isleme_hizi_skoru || 89,
                scores.gorsel_isleme_skoru || 32,
                scores.akil_mantik_yurutme_skoru || 17,
                scores.bilissel_esneklik_skoru || 57
            ];

            new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['Dikkat', 'Hafıza', 'İşleme Hızı', 'Görsel İşleme', 'Akıl Mantık', 'Bilişsel Esneklik'],
                    datasets: [{
                        label: 'Bilişsel Beceriler',
                        data: data,
                        backgroundColor: 'rgba(44, 90, 160, 0.2)',
                        borderColor: 'rgba(44, 90, 160, 1)',
                        borderWidth: 2,
                        pointBackgroundColor: 'rgba(44, 90, 160, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(44, 90, 160, 1)',
                        pointRadius: 5,
                        pointHoverRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'point',
                        intersect: true
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            enabled: true,
                            backgroundColor: 'rgba(0,0,0,0.8)',
                            titleColor: '#fff',
                            bodyColor: '#fff',
                            borderColor: 'rgba(44, 90, 160, 1)',
                            borderWidth: 1,
                            displayColors: false,
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': %' + context.parsed.r;
                                }
                            }
                        }
                    },
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                stepSize: 20
                            }
                        }
                    }
                }
            });
        }

        // OLD BAR CHART FUNCTION REMOVED - Using clean version above

        // Get session ID from URL parameters
        function getSessionIdFromUrl() {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('session_id');
        }

        // Performance optimized initialization
        document.addEventListener('DOMContentLoaded', async function() {
            logger.log('🚀 Initializing cognitive report...');

            // Prevent duplicate init during Vite HMR
            if (window.__cogInitRunning__) return;
            window.__cogInitRunning__ = true;
            
            try {
                // Get session ID from URL
                const sessionId = getSessionIdFromUrl();
                
                // Optimized loading process
                const initializeReport = async () => {
                    try {
                        // Show loading state immediately
                        const loadingOverlay = document.getElementById('loadingOverlay');
                        if (loadingOverlay) {
                            loadingOverlay.style.display = 'flex';
                            loadingOverlay.innerHTML = `
                                <div style="text-align: center;">
                                    <div class="spinner"></div>
                                    <div style="font-size: 18px; margin-bottom: 10px; color: #333;">Rapor Yükleniyor...</div>
                                    <div style="font-size: 14px; color: #666;">Veritabanından veriler alınıyor</div>
                                </div>
                            `;
                        }
                        
                        if (!sessionId) {
                            logger.warn('⚠️ No session_id found in URL parameters');
                            await new Promise(resolve => setTimeout(resolve, 200)); // Small delay for better UX
                            populateAllData();
                            finishLoading();
                            return;
                        }
                        
                        logger.log('📋 Session ID found:', sessionId);
                        
                        // Load data with timeout for better UX
                        const timeoutPromise = new Promise((_, reject) => 
                            setTimeout(() => reject(new Error('Database timeout')), 5000)
                        );
                        
                        try {
                            const dataLoaded = await Promise.race([
                                loadCognitiveData(sessionId),
                                timeoutPromise
                            ]);
                            
                            if (!dataLoaded) {
                                logger.warn('⚠️ Failed to load data, showing sample data');
                                populateAllData();
                            }
                        } catch (error) {
                            logger.error('Database loading error:', error);
                            populateAllData();
                        }
                        
                        finishLoading();
                        
                    } catch (error) {
                        logger.error('Initialization error:', error);
                        populateAllData();
                        finishLoading();
                    }
                };
                
                // Helper function to finish loading process
                const finishLoading = () => {
                    // Hide loading overlay
                    const loadingOverlay = document.getElementById('loadingOverlay');
                    if (loadingOverlay) {
                        loadingOverlay.style.display = 'none';
                    }
                    
                    // Show content with smooth transition
                    document.body.classList.add('loaded');
                    
                    // Initialize charts after content is shown
                    requestAnimationFrame(() => {
                        try {
                            destroyAllCharts();
                            
                            // Simple chart creation - reference based
                            createRadarChart(); // Update with loaded data
                            
                            logger.log('✅ Charts initialized successfully');
                        } catch (chartError) {
                            logger.error('Chart initialization error:', chartError);
                        }
                    });
                };
                
                // Start initialization immediately
                initializeReport();
                
            } catch (error) {
                logger.error('Initialization error:', error);
                // Fallback to sample data
                populateAllData();
                const loadingOverlay = document.getElementById('loadingOverlay');
                if (loadingOverlay) {
                    loadingOverlay.style.display = 'none';
                }
                document.body.classList.add('loaded');
            }
            
            logger.log('✅ Cognitive report initialization complete');
            window.__cogInitRunning__ = false;
        });
    </script>
</body>
</html>
